<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"wangwen135.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
<meta property="og:type" content="website">
<meta property="og:title" content="王某某的笔记">
<meta property="og:url" content="https://wangwen135.github.io/page/10/index.html">
<meta property="og:site_name" content="王某某的笔记">
<meta property="og:description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="王某某">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://wangwen135.github.io/page/10/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/10/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>王某某的笔记</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">王某某的笔记</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录我的编程之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="王某某"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">王某某</p>
  <div class="site-description" itemprop="description">这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">158</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">121</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/wangwen135" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wangwen135" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianshu.com/u/66c41e72644b" title="简  书 → https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;66c41e72644b" rel="noopener me" target="_blank"><i class="fa fa-link fa-fw"></i>简  书</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wangwen135@gmail.com" title="E-Mail → mailto:wangwen135@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/wangwen135" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;wangwen135" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C/%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C/%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80/" class="post-title-link" itemprop="url">广播地址</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-17 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-17T00:00:00+08:00">2020-04-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">网络与安全</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">网络</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>428</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="广播地址"><a href="#广播地址" class="headerlink" title="广播地址"></a>广播地址</h2><p>广播地址(Broadcast Address)是专门用于同时向网络中所有工作站进行发送的一个地址。在使用TCP&#x2F;IP 协议的网络中，主机标识段host ID 为全1 的IP 地址为广播地址，广播的分组传送给host ID段所涉及的所有计算机。例如，对于10.1.1.0 （255.255.255.0 ）网段，其广播地址为10.1.1.255 （255 即为2 进制的11111111 ），当发出一个目的地址为10.1.1.255 的分组（封包）时，它将被分发给该网段上的所有计算机。</p>
<h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><p>广播地址应用于网络内的所有主机</p>
<p><strong>1)受限广播</strong><br>它不被路由发送，但会被送到相同物理网络段上的所有主机<br>IP地址的网络字段和主机字段全为1就是地址255.255.255.255</p>
<p><strong>2)直接广播</strong><br>网络广播会被路由，并会发送到专门网络上的每台主机<br>IP地址的网络字段定义这个网络，主机字段通常全为1，如 192.168.10.255</p>
<h3 id="广播和地址"><a href="#广播和地址" class="headerlink" title="广播和地址"></a>广播和地址</h3><ol>
<li>TCP&#x2F;IP协议栈中, 传输层只有UDP可以广播.  </li>
<li>只能对同一子网内部广播, 广播数据包不经过路由器.  </li>
<li>UDP的广播地址为255.255.255.255  </li>
<li>在winsock实现中, 有一个选项对应是否允许广播.必须调用setsockopt打开该选项.  </li>
<li>打开后, 用sendto向255.255.255.255发送的数据包全部广播.</li>
</ol>
<p>很多局域网都定义了一个特殊的保留地址, 称为广播地址. 当信息头中目的地址域的内容为广播地址时, 该帧被局域网上所有计算机接收. 这个过程称为广播.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/Maven/maven%E6%89%93%E5%8C%85%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%9A%84jar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Maven/maven%E6%89%93%E5%8C%85%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%9A%84jar/" class="post-title-link" itemprop="url">maven打包可运行的jar</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-09 23:41:00" itemprop="dateCreated datePublished" datetime="2020-04-09T23:41:00+08:00">2020-04-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Maven/" itemprop="url" rel="index"><span itemprop="name">Maven</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>463</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="一：maven-jar-plugin"><a href="#一：maven-jar-plugin" class="headerlink" title="一：maven-jar-plugin"></a>一：maven-jar-plugin</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">	&lt;plugins&gt;</span><br><span class="line">		&lt;plugin&gt;</span><br><span class="line">			&lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span><br><span class="line">			&lt;configuration&gt;</span><br><span class="line">				&lt;archive&gt;</span><br><span class="line">					&lt;manifest&gt;</span><br><span class="line">						&lt;mainClass&gt;com.xxx.xxx.Main&lt;/mainClass&gt;</span><br><span class="line">					&lt;/manifest&gt;</span><br><span class="line">				&lt;/archive&gt;</span><br><span class="line">			&lt;/configuration&gt;</span><br><span class="line">		&lt;/plugin&gt;</span><br><span class="line">	&lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure>
<p>maven-jar-plugin用于生成META-INF&#x2F;MANIFEST.MF文件的部分内容  </p>
<blockquote>
<p><mainClass>com.xxg.Main</mainClass></p>
</blockquote>
<p>指定MANIFEST.MF中的Main-Class</p>
<p>排除目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">	&lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">		&lt;!-- jar包中排除groovy脚本目录 --&gt;</span><br><span class="line">		&lt;excludes&gt;</span><br><span class="line">			&lt;exclude&gt;groovy/&lt;/exclude&gt;</span><br><span class="line">		&lt;/excludes&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<p>排除文件，可以用通配符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;2.4&lt;/version&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">		&lt;!-- jar包中排除这些文件 --&gt;</span><br><span class="line">		&lt;excludes&gt;</span><br><span class="line">			&lt;exclude&gt;log4j.properties&lt;/exclude&gt;</span><br><span class="line">			&lt;exclude&gt;conf.properties&lt;/exclude&gt;</span><br><span class="line">			&lt;exclude&gt;system.properties&lt;/exclude&gt;</span><br><span class="line">			&lt;exclude&gt;logback.xml&lt;/exclude&gt;</span><br><span class="line">			&lt;exclude&gt;log4j2.xml&lt;/exclude&gt;</span><br><span class="line">		&lt;/excludes&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>


<h2 id="二：maven-assembly-plugin"><a href="#二：maven-assembly-plugin" class="headerlink" title="二：maven-assembly-plugin"></a>二：maven-assembly-plugin</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;2.6&lt;/version&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">		&lt;descriptorRefs&gt;</span><br><span class="line">			&lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;</span><br><span class="line">		&lt;/descriptorRefs&gt;</span><br><span class="line">		&lt;archive&gt;</span><br><span class="line">			&lt;manifest&gt;</span><br><span class="line">				&lt;mainClass&gt;com.xxx.xxx.Main&lt;/mainClass&gt;</span><br><span class="line">			&lt;/manifest&gt;</span><br><span class="line">		&lt;/archive&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">	&lt;executions&gt;</span><br><span class="line">		&lt;execution&gt;</span><br><span class="line">			&lt;id&gt;make-assembly&lt;/id&gt;</span><br><span class="line">			&lt;phase&gt;package&lt;/phase&gt;</span><br><span class="line">			&lt;goals&gt;</span><br><span class="line">				&lt;goal&gt;single&lt;/goal&gt;</span><br><span class="line">			&lt;/goals&gt;</span><br><span class="line">		&lt;/execution&gt;</span><br><span class="line">	&lt;/executions&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>

<p>这里没有指定</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;descriptor&gt;src/main/assembly/assembly.xml&lt;/descriptor&gt;  </span><br></pre></td></tr></table></figure>
<p>而是用的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;descriptorRefs&gt;</span><br><span class="line">	&lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;</span><br><span class="line">&lt;/descriptorRefs&gt;</span><br></pre></td></tr></table></figure>
<p>这个jar-with-dependencies是assembly预先写好的一个，组装描述引用（assembly descriptor）</p>
<p>默认的compile scope范围是会打进jar包的，而且依赖也全部会打进去，所有有些包打完之后有可能会很大，可将scope范围改成provided，就不会打进去了。</p>
<p>指定打包输出的文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">	&lt;finalName&gt;CSV转Excel工具&lt;/finalName&gt;</span><br><span class="line">	&lt;appendAssemblyId&gt;false&lt;/appendAssemblyId&gt;</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h2 id="常规做法"><a href="#常规做法" class="headerlink" title="常规做法"></a>常规做法</h2><p>一般项目都比较大，不会打成一个jar包，一般都是打成一个tar包，里面包含启动脚本，配置文件等</p>
<p>使用assembly插件  </p>
<h3 id="一般目录结构如下："><a href="#一般目录结构如下：" class="headerlink" title="一般目录结构如下："></a>一般目录结构如下：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">│</span><br><span class="line">└─assembly</span><br><span class="line">	│  assembly.xml</span><br><span class="line">	│</span><br><span class="line">	├─bin</span><br><span class="line">	│      dump.sh</span><br><span class="line">	│      restart.sh</span><br><span class="line">	│      server.sh</span><br><span class="line">	│      start.sh</span><br><span class="line">	│      stop.sh</span><br><span class="line">	│</span><br><span class="line">	└─conf</span><br><span class="line">			log4j.properties</span><br><span class="line">			system.properties</span><br></pre></td></tr></table></figure>

<h3 id="pom中配置assembly-插件"><a href="#pom中配置assembly-插件" class="headerlink" title="pom中配置assembly 插件"></a>pom中配置assembly 插件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.6&lt;/version&gt;</span><br><span class="line">    &lt;configuration&gt;</span><br><span class="line">        &lt;descriptor&gt;src/main/assembly/assembly.xml&lt;/descriptor&gt;</span><br><span class="line">    &lt;/configuration&gt;</span><br><span class="line">    &lt;executions&gt;</span><br><span class="line">        &lt;execution&gt;</span><br><span class="line">            &lt;id&gt;make-assembly&lt;/id&gt;</span><br><span class="line">            &lt;phase&gt;package&lt;/phase&gt;</span><br><span class="line">            &lt;goals&gt;</span><br><span class="line">                &lt;goal&gt;single&lt;/goal&gt;</span><br><span class="line">            &lt;/goals&gt;</span><br><span class="line">        &lt;/execution&gt;</span><br><span class="line">    &lt;/executions&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<h3 id="assembly-xml"><a href="#assembly-xml" class="headerlink" title="assembly.xml"></a>assembly.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;assembly&gt;</span><br><span class="line">	&lt;id&gt;assembly&lt;/id&gt;</span><br><span class="line">	&lt;formats&gt;</span><br><span class="line">		&lt;format&gt;tar.gz&lt;/format&gt;</span><br><span class="line">	&lt;/formats&gt;</span><br><span class="line">	&lt;includeBaseDirectory&gt;true&lt;/includeBaseDirectory&gt;</span><br><span class="line">	&lt;fileSets&gt;</span><br><span class="line">		&lt;fileSet&gt;</span><br><span class="line">			&lt;directory&gt;src/main/assembly/bin&lt;/directory&gt;</span><br><span class="line">			&lt;outputDirectory&gt;bin&lt;/outputDirectory&gt;</span><br><span class="line">			&lt;fileMode&gt;0755&lt;/fileMode&gt;</span><br><span class="line">		&lt;/fileSet&gt;</span><br><span class="line">		&lt;fileSet&gt;</span><br><span class="line">			&lt;directory&gt;src/main/assembly/conf&lt;/directory&gt;</span><br><span class="line">			&lt;outputDirectory&gt;conf&lt;/outputDirectory&gt;</span><br><span class="line">			&lt;fileMode&gt;0644&lt;/fileMode&gt;</span><br><span class="line">		&lt;/fileSet&gt;</span><br><span class="line">	&lt;/fileSets&gt;</span><br><span class="line">	&lt;dependencySets&gt;</span><br><span class="line">		&lt;dependencySet&gt;</span><br><span class="line">			&lt;outputDirectory&gt;lib&lt;/outputDirectory&gt;</span><br><span class="line">		&lt;/dependencySet&gt;</span><br><span class="line">	&lt;/dependencySets&gt;</span><br><span class="line">&lt;/assembly&gt;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/Zookeeper/Zookeeper/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Zookeeper/Zookeeper/" class="post-title-link" itemprop="url">Zookeeper</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-17 23:41:00" itemprop="dateCreated datePublished" datetime="2020-03-17T23:41:00+08:00">2020-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Zookeeper/" itemprop="url" rel="index"><span itemprop="name">Zookeeper</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>778</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ZooKeeper是一个分布式的，开放源码的分布式应用程序协调服务，是Google的Chubby一个开源的实现，是Hadoop和Hbase的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务、互斥锁等。</p>
<p>ZooKeeper是一个高性能，可扩展的服务，只要集群中超过一半的节点正常，那么整个集群就可以正常对外提供服务。Zookeeper有数据一致性的保证：顺序一致性，客户端的更新会按照它们发送的次序排序；原子性，更新要么成功，要么失败，不会出现部分成功的（更新操作）结果。单独系统镜像，不管客户端连哪个服务器，它看来都是同一个。可靠性，一旦更新生效，它就会一直保存到下一次客户端更新。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h4 id="下载："><a href="#下载：" class="headerlink" title="下载："></a>下载：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 这个已经不是稳定了</span><br><span class="line">wget http://archive.apache.org/dist/zookeeper/stable/zookeeper-3.4.6.tar.gz</span><br><span class="line"></span><br><span class="line"># </span><br><span class="line">http://archive.apache.org/dist/zookeeper/zookeeper-3.3.6/zookeeper-3.3.6.tar.gz</span><br><span class="line">http://archive.apache.org/dist/zookeeper/zookeeper-3.4.8/zookeeper-3.4.8.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="解压与软链接："><a href="#解压与软链接：" class="headerlink" title="解压与软链接："></a>解压与软链接：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf zookeeper-3.4.6.tar.gz -C /opt</span><br><span class="line"></span><br><span class="line">#可以不要</span><br><span class="line">ln -s /opt/zookeeper-3.4.6 /opt/zookeeper</span><br><span class="line"></span><br><span class="line">chown -R zookeeper:zookeeper /opt/zookeeper*</span><br></pre></td></tr></table></figure>

<h4 id="复制配置文件"><a href="#复制配置文件" class="headerlink" title="复制配置文件"></a>复制配置文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp conf/zoo_sample.cfg conf/zoo.cfg</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="zoo-cfg"><a href="#zoo-cfg" class="headerlink" title="zoo.cfg"></a>zoo.cfg</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line"></span><br><span class="line">#数据目录. 可以是任意目录</span><br><span class="line">dataDir=/home/zookeeper/data</span><br><span class="line"></span><br><span class="line">#log目录, 可以是任意目录</span><br><span class="line">dataLogDir=/home/zookeeper/dataLog</span><br><span class="line"></span><br><span class="line">#client连接的端口</span><br><span class="line">clientPort=2181</span><br><span class="line"></span><br><span class="line">#配置集群</span><br><span class="line">server.1=192.168.1.213:2888:3888</span><br><span class="line">server.2=192.168.1.214:2888:3888</span><br><span class="line">server.3=192.168.1.215:2888:3888</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>server.A&#x3D;B：C：D：其中A 是一个数字，表示这个是第几号服务器；B 是这个服务器的 ip 地址；C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口。</p>
</blockquote>
<p>在 <strong>dataDir</strong> 目录中创建一个名为 <strong>myid</strong> 文件，在文件中写入节点ID，与zoo.cfg中的集群配置相对应</p>
<blockquote>
<p>在集群模式中各server的dataDir目录下的myid文件中的数字必须不同</p>
</blockquote>
<pre><code>单机版直接解压缩启动就可以了，不用改什么配置
</code></pre>
<h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><p>启动  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh start  </span><br></pre></td></tr></table></figure>

<p>查看状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh status</span><br></pre></td></tr></table></figure>

<p>停止  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh stop</span><br></pre></td></tr></table></figure>

<p>启动client连接server  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkCli.sh -server localhost:2181  </span><br></pre></td></tr></table></figure>


<h2 id="查看状态"><a href="#查看状态" class="headerlink" title="查看状态"></a>查看状态</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo stat | nc 192.168.1.213 2181</span><br><span class="line">echo stat | nc 192.168.1.214 2181</span><br><span class="line">echo stat | nc 192.168.1.215 2181</span><br><span class="line">echo stat | nc 192.168.1.216 2181</span><br><span class="line">echo stat | nc 192.168.1.217 2181</span><br></pre></td></tr></table></figure>

<h2 id="服务化"><a href="#服务化" class="headerlink" title="服务化"></a>服务化</h2><p>【基于 CentOS 7】</p>
<p>在&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F; 目录中创建zookeeper.service文件。<br>文件内容如下：  </p>
<blockquote>
<p>日志目录和安装目录自己按照实际情况改</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Zookeeper Service</span><br><span class="line">After=network.target </span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Environment=ZOO_LOG_DIR=/data/zookeeper/zookeeper-3.4.8/</span><br><span class="line">Type=forking</span><br><span class="line">User=dap</span><br><span class="line">ExecStart=/data/zookeeper/zookeeper-3.4.8/bin/zkServer.sh start</span><br><span class="line">ExecStop=/data/zookeeper/zookeeper-3.4.8/bin/zkServer.sh stop</span><br><span class="line">ExecReload=/data/zookeeper/zookeeper-3.4.8/bin/zkServer.sh restart</span><br><span class="line">SuccessExitStatus=SIGKILL</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>再执行如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 重新加载</span><br><span class="line">systemctl daemon-reload</span><br><span class="line"></span><br><span class="line">#启动服务</span><br><span class="line">systemctl start zookeeper</span><br><span class="line"></span><br><span class="line">#查看服务启动情况</span><br><span class="line">systemctl status zookeeper</span><br><span class="line"></span><br><span class="line">#设置为开机启动</span><br><span class="line">systemctl enable zookeeper</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/Redis/Redis%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Redis/Redis%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">Redis基本命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-06 23:41:00" itemprop="dateCreated datePublished" datetime="2020-03-06T23:41:00+08:00">2020-03-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="使用客户端工具"><a href="#使用客户端工具" class="headerlink" title="使用客户端工具"></a>使用客户端工具</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/redis-cli </span><br></pre></td></tr></table></figure>

<p>测试命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p>redis 可以提供16个数据库</p>
<p>通过select 选择，默认是0数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; select 1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[1]&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line">127.0.0.1:6379[1]&gt; select 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line"> 1) &quot;num&quot;</span><br><span class="line"> 2) &quot;myb2&quot;</span><br><span class="line"> 3) &quot;mylist2&quot;</span><br><span class="line"> 4) &quot;myhash&quot;</span><br><span class="line"> 5) &quot;myb1&quot;</span><br><span class="line"> 6) &quot;myset&quot;</span><br><span class="line"> 7) &quot;name&quot;</span><br><span class="line"> 8) &quot;eclipse&quot;</span><br><span class="line"> 9) &quot;myb3&quot;</span><br><span class="line">10) &quot;name2&quot;</span><br><span class="line">11) &quot;mya1&quot;</span><br><span class="line">12) &quot;mylist&quot;</span><br><span class="line">13) &quot;mya2&quot;</span><br><span class="line">14) &quot;mysort&quot;</span><br><span class="line">15) &quot;myahs&quot;</span><br><span class="line">16) &quot;aa1&quot;</span><br><span class="line">17) &quot;mya3&quot;</span><br></pre></td></tr></table></figure>

<p>清空数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flushall</span><br></pre></td></tr></table></figure>

<h2 id="基本数据"><a href="#基本数据" class="headerlink" title="基本数据"></a>基本数据</h2><p>存数据  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set name zhangsan</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>获取数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">&quot;zhangsan&quot;</span><br></pre></td></tr></table></figure>

<p>删除数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; del name</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>

<p>查看所有的key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;name2&quot;</span><br><span class="line">2) &quot;name&quot;</span><br></pre></td></tr></table></figure>
<p>查看匹配可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys a*</span><br><span class="line">1) &quot;abc&quot;</span><br><span class="line">2) &quot;aa1&quot;</span><br></pre></td></tr></table></figure>


<p>数字递增</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; incr num</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;1&quot;</span><br><span class="line">127.0.0.1:6379&gt; incr num</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;2&quot;</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></table></figure>
<p>如果不存在会设置初始值为0，然后+1</p>
<p>数字递减</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; decr num</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;1&quot;</span><br><span class="line">127.0.0.1:6379&gt; decr num</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;0&quot;</span><br><span class="line">127.0.0.1:6379&gt; </span><br><span class="line">127.0.0.1:6379&gt; decr num</span><br><span class="line">(integer) -1</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;-1&quot;</span><br></pre></td></tr></table></figure>

<p>数字增加指定的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; incrby num 5</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; incrby num 5</span><br><span class="line">(integer) 9</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></table></figure>

<p>数字减去指定的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; decrby num 3</span><br><span class="line">(integer) 6</span><br><span class="line">127.0.0.1:6379&gt; decrby num 3</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; decrby num 3</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></table></figure>

<p>拼接字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; append name laoli</span><br><span class="line">(integer) 13</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">&quot;zhangsanlaoli&quot;</span><br></pre></td></tr></table></figure>

<p>重命名KEY</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set a1 a1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get a1</span><br><span class="line">&quot;a1&quot;</span><br><span class="line">127.0.0.1:6379&gt; rename a1 aa1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get a1</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get aa1</span><br><span class="line">&quot;a1&quot;</span><br></pre></td></tr></table></figure>

<p>设置过期时间<br>单位秒</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get abc</span><br><span class="line">&quot;abc&quot;</span><br><span class="line">127.0.0.1:6379&gt; expire abc 10</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; get abc</span><br><span class="line">&quot;abc&quot;</span><br><span class="line">127.0.0.1:6379&gt; get abc</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>

<p>查看超时时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set abc abc</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get abc</span><br><span class="line">&quot;abc&quot;</span><br><span class="line">127.0.0.1:6379&gt; ttl abc</span><br><span class="line">(integer) -1</span><br><span class="line">127.0.0.1:6379&gt; expire abc 100</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ttl abc</span><br><span class="line">(integer) 96</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></table></figure>

<p>获取key存储的数据类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; type abc</span><br><span class="line">string</span><br><span class="line">127.0.0.1:6379&gt; type mylist</span><br><span class="line">list</span><br><span class="line">127.0.0.1:6379&gt; type myset</span><br><span class="line">set</span><br></pre></td></tr></table></figure>

<h2 id="Hash-类型"><a href="#Hash-类型" class="headerlink" title="Hash 类型"></a>Hash 类型</h2><p>设值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset myhash uname zhangsan</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hset myhash age 18</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>

<p>设置多个值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hmset myhash2 uname zhangs age 11</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>取值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hget myhash uname</span><br><span class="line">&quot;zhangsan&quot;</span><br></pre></td></tr></table></figure>

<p>一次取多个值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hmget myhash uname age</span><br><span class="line">1) &quot;zhangsan&quot;</span><br><span class="line">2) &quot;18&quot;</span><br></pre></td></tr></table></figure>

<p>获取全部值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) &quot;uname&quot;</span><br><span class="line">2) &quot;zhangsan&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;18&quot;</span><br></pre></td></tr></table></figure>

<p>删除一个值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hdel myhash2 uname age</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; hgetall myhash2</span><br><span class="line">(empty list or set)</span><br></pre></td></tr></table></figure>
<p>删除不存在的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hdel myhash2 uname</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>

<p>删除整个集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hmset myhash2 uname zhangs age 21</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; del myhash2</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hget myhash2 uname</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>

<p>增加数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hget myhash age</span><br><span class="line">&quot;18&quot;</span><br><span class="line">127.0.0.1:6379&gt; hincrby myhash age 5</span><br><span class="line">(integer) 23</span><br><span class="line">127.0.0.1:6379&gt; hget myhash age</span><br><span class="line">&quot;23&quot;</span><br></pre></td></tr></table></figure>

<p>判断hash中某个键值是否存在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hexists myhash uname</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>
<p>1表示存在，0表示不存在</p>
<p>获取HASH中的键值对数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) &quot;uname&quot;</span><br><span class="line">2) &quot;zhangsan&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;23&quot;</span><br><span class="line">127.0.0.1:6379&gt; hlen myhash</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<p>获取Hash中所有的key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hkeys myhash</span><br><span class="line">1) &quot;uname&quot;</span><br><span class="line">2) &quot;age&quot;</span><br></pre></td></tr></table></figure>

<p>获取hash中所有的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hvals myhash</span><br><span class="line">1) &quot;zhangsan&quot;</span><br><span class="line">2) &quot;23&quot;</span><br></pre></td></tr></table></figure>

<h2 id="数据结构list"><a href="#数据结构list" class="headerlink" title="数据结构list"></a>数据结构list</h2><p>ArrayList使用数组方式， LinkedList使用双向链表</p>
<p>从左侧向列表中添加数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpush mylist a b c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; lpush mylist 1 2 3</span><br><span class="line">(integer) 6</span><br><span class="line">127.0.0.1:6379&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>右侧添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rpush mylist2 a b c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; rpush mylist2 1 2 3</span><br><span class="line">(integer) 6</span><br></pre></td></tr></table></figure>

<p>查看列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange mylist 0 5</span><br><span class="line">1) &quot;3&quot;</span><br><span class="line">2) &quot;2&quot;</span><br><span class="line">3) &quot;1&quot;</span><br><span class="line">4) &quot;c&quot;</span><br><span class="line">5) &quot;b&quot;</span><br><span class="line">6) &quot;a&quot;</span><br></pre></td></tr></table></figure>
<p>后面指定范围，可以是负数，负数从后面开始</p>
<p>弹出列表中的元素<br>左侧弹出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpop mylist</span><br><span class="line">&quot;3&quot;</span><br></pre></td></tr></table></figure>
<p>右侧弹出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rpop mylist2</span><br><span class="line">&quot;3&quot;</span><br></pre></td></tr></table></figure>

<p>获取列表中的元素数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; llen mylist</span><br><span class="line">(integer) 5</span><br></pre></td></tr></table></figure>

<p>lrem 删除</p>
<p>lset 设置某个index 的值</p>
<p>插入 linsert 列表 before index value</p>
<p>rpoplpush 列表1 列表2   从一个队列中移除添加到另外一个队列中</p>
<h2 id="数据结构set"><a href="#数据结构set" class="headerlink" title="数据结构set"></a>数据结构set</h2><p>Set不允许出现重复的元素</p>
<p>添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd myset a b c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; sadd myset a </span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>


<p>删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd myset 1 2 3</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; srem myset 1 2</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<p>查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers myset</span><br><span class="line">1) &quot;a&quot;</span><br><span class="line">2) &quot;b&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line">4) &quot;3&quot;</span><br></pre></td></tr></table></figure>

<p>判断是否存在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sismember myset a</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sismember myset x</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>
<p>1表示存在，0表示不存在</p>
<p>差集运算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd mya1 a b c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; sadd myb1 a c 1 2</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; sdiff mya1 myb1</span><br><span class="line">1) &quot;b&quot;</span><br></pre></td></tr></table></figure>

<p>交集运算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd mya2 a b c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; sadd myb2 a c 1 2</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; sinter mya2 myb2</span><br><span class="line">1) &quot;a&quot;</span><br><span class="line">2) &quot;c&quot;</span><br></pre></td></tr></table></figure>

<p>并集运算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd mya3 a b c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; sadd myb3 a c 1 2</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; sunion mya3 myb3</span><br><span class="line">1) &quot;2&quot;</span><br><span class="line">2) &quot;a&quot;</span><br><span class="line">3) &quot;1&quot;</span><br><span class="line">4) &quot;c&quot;</span><br><span class="line">5) &quot;b&quot;</span><br></pre></td></tr></table></figure>

<p>获取set中的成员数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; scard myset</span><br><span class="line">(integer) 4</span><br></pre></td></tr></table></figure>

<p>随机返回一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line">&quot;b&quot;</span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line">&quot;c&quot;</span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line">&quot;a&quot;</span><br></pre></td></tr></table></figure>

<p>存储交集、并集、差集到一个新的集合中<br>sdiffstore sinterstore sunionstore</p>
<h2 id="sorted-set"><a href="#sorted-set" class="headerlink" title="sorted-set"></a>sorted-set</h2><p>排序，有个分数</p>
<p>添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd mysort 70 zhangsan 80 lisi 90 wangwu</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; zadd mysort 100 zhangsan</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; zadd mysort 60 tom</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>

<p>获取分数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zscore mysort zhangsan</span><br><span class="line">&quot;100&quot;</span><br></pre></td></tr></table></figure>

<p>或成员数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zcard mysort</span><br><span class="line">(integer) 4</span><br></pre></td></tr></table></figure>

<p>删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrem mysort tom wangwu</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zcard mysort</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<p>范围查找</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd mysort 85 jack 95 rose</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zrange mysort 0 -1</span><br><span class="line">1) &quot;lisi&quot;</span><br><span class="line">2) &quot;jack&quot;</span><br><span class="line">3) &quot;rose&quot;</span><br><span class="line">4) &quot;zhangsan&quot;</span><br></pre></td></tr></table></figure>
<p>显示分数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange mysort 0 -1 withscores</span><br><span class="line">1) &quot;lisi&quot;</span><br><span class="line">2) &quot;80&quot;</span><br><span class="line">3) &quot;jack&quot;</span><br><span class="line">4) &quot;85&quot;</span><br><span class="line">5) &quot;rose&quot;</span><br><span class="line">6) &quot;95&quot;</span><br><span class="line">7) &quot;zhangsan&quot;</span><br><span class="line">8) &quot;100&quot;</span><br></pre></td></tr></table></figure>
<p>从大到小</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrevrange mysort 0 -1 withscores</span><br><span class="line">1) &quot;zhangsan&quot;</span><br><span class="line">2) &quot;100&quot;</span><br><span class="line">3) &quot;rose&quot;</span><br><span class="line">4) &quot;95&quot;</span><br><span class="line">5) &quot;jack&quot;</span><br><span class="line">6) &quot;85&quot;</span><br><span class="line">7) &quot;lisi&quot;</span><br><span class="line">8) &quot;80&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>范围删除<br>zremrangebyrank mysort 0 4</p>
<p>按照分数删除<br>zremrangebyscore mysort 80 100</p>
<h2 id="事物"><a href="#事物" class="headerlink" title="事物"></a>事物</h2><p>开启事物<br>multi</p>
<p>提交事物<br>exec </p>
<p>回滚事物<br>discard</p>
<hr>
<hr>
<hr>
<p>图形化客户端工具 Redis Desktop Manager 更好用 </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/Selenium/Selenium-%E4%B8%8E-ChromeDriver/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Selenium/Selenium-%E4%B8%8E-ChromeDriver/" class="post-title-link" itemprop="url">Selenium-与-ChromeDriver</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-15 23:41:00" itemprop="dateCreated datePublished" datetime="2020-02-15T23:41:00+08:00">2020-02-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Selenium/" itemprop="url" rel="index"><span itemprop="name">Selenium</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>7 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><em>王某某瞎编于 2018年3月20日</em></p>
<h2 id="Selenium"><a href="#Selenium" class="headerlink" title="Selenium"></a>Selenium</h2><p>Selenium 是 ThoughtWorks 提供的一个强大的基于浏览器的开源自动化测试工具。<br>Selenium 是一个用于 Web 应用程序测试的工具，测试直接自动运行在浏览器中，就像真正的用户在手工操作一样。支持的浏览器包括 IE、Chrome 和 Firefox 等。这个工具的主要功能包括：测试与浏览器的兼容性 - 测试您的应用程序看是否能够很好地工作在不同浏览器和操作系统之上；测试系统功能 - 创建回归测试检验软件功能和用户需求；支持自动录制动作，和自动生成 .NET、Perl、Python、Ruby 和 Java 等不同语言的测试脚本。  </p>
<p>Selenium 1 (又叫 Selenium RC 或 Remote Control)</p>
<h2 id="Webdriver"><a href="#Webdriver" class="headerlink" title="Webdriver"></a>Webdriver</h2><p>Selenium 2，又名 WebDriver，它的主要新功能是集成了 Selenium 1.0 以及 WebDriver， 是两个项目的合并，既兼容  Selenium API 也支持 WebDriver API。  </p>
<p>WebDriver 曾经是 Selenium 的竞争对手（最开始是google的一个人弄的，主要用于避免在JavaScript的沙箱环境里存在的各种限制），他主要是通过利用浏览器原生API的方式来操控浏览器执行各种动作（还包括系统级别的调用来模拟用户输入）。</p>
<p>Selenium WebDriver 就是对浏览器提供的原生API进行封装，使其成为一套更加面向对象的Selenium WebDriver API。<br>使用这套API可以操控浏览器的开启、关闭，打开网页，操作界面元素，控制Cookie，还可以操作浏览器截屏、安装插件、设置代理、配置证书等。由于使用的原生API，其速度与稳定性都会好很多。但浏览器厂商各不相同，提供的驱动各异（ChromeDriver、FirefoxDriver(xpi插件)、InternetExplorerDriver(exe)等），API也会有差异（好像都走JSON Wire Protocol，并且向W3C标准靠拢）。Selenium 对不同厂商的各个驱动进行了封装，如：selenium-chrome-driver、selenium-edge-driver、selenium-firefox-driver等。<br>还包括了对移动应用进行测试的AndroidDriver和iOS WebDriver，以及一个基于HtmlUnit的无界面实现HtmlUnitDriver。</p>
<p>WebDriver API可以通过Python、Ruby、Java和C#访问</p>
<p>WebDriver是一个用来进行复杂重复的web自动化测试的工具。意在提供一种比Selenium1.0更简单易学，有利于维护的API。它没有和任何测试框架进行绑定，所以他可以很好的在单元测试和main方法中调用。一旦创建好一个Selenium工程，你马上会发现WebDriver和其他类库一样：它是完全独立的，你可以直接使用而不需要考虑其他配置，这个Selenium RC是截然相反的。</p>
<h3 id="两者的差异"><a href="#两者的差异" class="headerlink" title="两者的差异"></a>两者的差异</h3><ul>
<li>对于所有类型的浏览器Selenium- RC都是使用的同一种方法：<br>当浏览器启动时，向其中注入javascript，从而使用这些js来驱动浏览器中的AUT(Application Under Test)。  </li>
<li>WebDriver并没有使用这种技术，它是通过调用浏览器原生的自动化API直接驱动浏览器。</li>
</ul>
<h3 id="Selenium-IDE"><a href="#Selenium-IDE" class="headerlink" title="Selenium IDE"></a>Selenium IDE</h3><p>Selenium IDE (集成开发环境) 是一个创建测试脚本的原型工具。它是一个 Firefox 插件，提供创建自动化测试的建议接口。Selenium IDE 有一个记录功能，能记录用户的操作，并且能选择多种语言把它们导出到一个可重用的脚本中用于后续执行。</p>
<hr>
<h2 id="ChromeDriver-WebDriver-for-Chrome"><a href="#ChromeDriver-WebDriver-for-Chrome" class="headerlink" title="ChromeDriver - WebDriver for Chrome"></a>ChromeDriver - WebDriver for Chrome</h2><p>WebDriver是一个开源工具，用于在许多浏览器上自动测试webapps。它提供了导航到网页，用户输入，JavaScript执行等功能。ChromeDriver是一个独立的服务，它为 Chromium 实现 WebDriver 的 JsonWireProtocol 协议。 </p>
<p>目前正在实现并转向W3C标准。 ChromeDriver适用于Android版Chrome和桌面版Chrome（Mac，Linux，Windows和ChromeOS）。</p>
<p>官网地址：<br><a target="_blank" rel="noopener" href="https://sites.google.com/a/chromium.org/chromedriver/home">https://sites.google.com/a/chromium.org/chromedriver/home</a></p>
<p>ChromeDriver 是 google 为网站开发人员提供的自动化测试接口，它是 <strong>selenium2</strong> 和 <strong>chrome浏览器</strong> 进行通信的桥梁。selenium 通过一套协议（JsonWireProtocol ：<a target="_blank" rel="noopener" href="https://github.com/SeleniumHQ/selenium/wiki/JsonWireProtocol%EF%BC%89%E5%92%8C">https://github.com/SeleniumHQ/selenium/wiki/JsonWireProtocol）和</a> ChromeDriver 进行通信，selenium 实质上是对这套协议的底层封装，同时提供外部 WebDriver 的上层调用类库。 </p>
<p><strong>大概的工作流程：</strong></p>
<p>在代码中 new ChromeDriver() 时，selenium会随机挑选一个端口调用chromedriver程序，调用成功后 chromedriver 会在指定的端口启动一个服务（会有一个进程）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;tasklist | find &quot;chromedriver&quot;</span><br><span class="line">chromedriver.exe              7848 Console                    1     13,740 K</span><br></pre></td></tr></table></figure>
<p>selenium 中使用 apache 的 commons-exec 来运行 chromedriver.exe 启动 ChromeDriver 服务<br>直接在控制台运行 chromedriver.exe 时，默认端口是9515</p>
<p>selenium 通过指定的端口和约定的协议来和 ChromeDriver 进行通信，一个ChromeDriver可用管理多个chrome。<br><em>（具体细节可以看看协议部分，ChromeDriver如何控制chrome可能需要去看源码~~）</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;tasklist | find &quot;chrome&quot;</span><br><span class="line">chromedriver.exe             14692 Console                    1     14,888 K</span><br><span class="line">chrome.exe                   20952 Console                    1     72,204 K</span><br><span class="line">chrome.exe                    7288 Console                    1      9,052 K</span><br><span class="line">chrome.exe                   15524 Console                    1     10,000 K</span><br><span class="line">chrome.exe                   13036 Console                    1     96,028 K</span><br><span class="line">chrome.exe                   11836 Console                    1     29,836 K</span><br><span class="line">chrome.exe                    2788 Console                    1     59,876 K </span><br></pre></td></tr></table></figure>
<p>selenium 中多个 WebDriver 实例对应一个 chromedriver 进程，一个 chromedriver 进程管理多个 chrome 进程。<br>一个 WebDriver 实例对应一个浏览器窗口。</p>
<p>在代码中直接 new ChromeDriver() 将会启动一个 chromedriver 进程<br>使用 RemoteWebDriver 则只会连接到 chromedriver 服务，不会启动一个新的进程，连接不上会报错。<br>不管哪种方式都会打开一个浏览器窗口。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WebDriver driver = new RemoteWebDriver(new URL(&quot;http://127.0.0.1:9515&quot;), DesiredCapabilities.chrome());</span><br></pre></td></tr></table></figure>

<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>官方指导页面</p>
<p><a target="_blank" rel="noopener" href="https://sites.google.com/a/chromium.org/chromedriver/getting-started">https://sites.google.com/a/chromium.org/chromedriver/getting-started</a></p>
<p>基于java</p>
<ol>
<li><p>创建Maven项目<br>引入相关依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.7.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>确保Chromium &#x2F; Google Chrome安装在认可的位置</p>
</li>
</ol>
<p>ChromeDriver希望您将Chrome安装在您平台的默认位置。您还可以强制ChromeDriver通过设置特殊功能来使用自定义位置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ChromeOptions options = new ChromeOptions();</span><br><span class="line">options.setBinary(&quot;/path/to/other/chrome/binary&quot;);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>下载与你安装的chrome对应的chromedriver</li>
</ol>
<table>
<thead>
<tr>
<th>chromedriver 版本</th>
<th>chrome 版本</th>
</tr>
</thead>
<tbody><tr>
<td>ChromeDriver 2.36</td>
<td>Chrome v63-65</td>
</tr>
<tr>
<td>ChromeDriver 2.35</td>
<td>Chrome v62-64</td>
</tr>
<tr>
<td>ChromeDriver 2.34</td>
<td>Chrome v61-63</td>
</tr>
<tr>
<td>ChromeDriver 2.33</td>
<td>Chrome v60-62</td>
</tr>
</tbody></table>
<p><em>（这里随便复制了几个）</em><br>下载地址：<br><a target="_blank" rel="noopener" href="https://sites.google.com/a/chromium.org/chromedriver/downloads">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></p>
<ol start="3">
<li>指定ChromeDriver所在位置，可以通过两种方法指定：</li>
</ol>
<ul>
<li><p>通过配置ChromeDriver.exe位置到path环境变量</p>
</li>
<li><p>通过设置<strong>webdriver.chrome.driver</strong> 系统属性实现-</p>
</li>
</ul>
<ol start="4">
<li>创建一个新的ChromeDriver的实例，并调用get方法打开页面</li>
</ol>
<p>代码:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import org.openqa.selenium.WebDriver;</span><br><span class="line">import org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line"></span><br><span class="line">public class BaseTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        // 设置ChromeDriver的路径</span><br><span class="line">        System.setProperty(&quot;webdriver.chrome.driver&quot;, &quot;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chromedriver.exe&quot;);</span><br><span class="line"></span><br><span class="line">        WebDriver driver = new ChromeDriver();</span><br><span class="line"></span><br><span class="line">        driver.get(&quot;http://www.baidu.com/&quot;);</span><br><span class="line">        </span><br><span class="line">        //driver.quit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行这段代码将打开一个浏览器窗口，并访问百度<br>同时浏览器上将显示：Chrome 正受到自动测试软件的控制</p>
<p>代码执行完成后chrome并不会关闭，需要调用 driver.quit(); 才能关闭浏览器窗口。</p>
<p>打开百度并进行搜索：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        // 如果不设置将搜索环境变量</span><br><span class="line">        System.setProperty(&quot;webdriver.chrome.driver&quot;, &quot;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chromedriver.exe&quot;);</span><br><span class="line"></span><br><span class="line">        WebDriver driver = new ChromeDriver();</span><br><span class="line">        driver.get(&quot;http://www.baidu.com/&quot;);</span><br><span class="line"></span><br><span class="line">        Thread.sleep(3000);</span><br><span class="line"></span><br><span class="line">        WebElement searchBox = driver.findElement(By.id(&quot;kw&quot;));</span><br><span class="line"></span><br><span class="line">        searchBox.sendKeys(&quot;ChromeDriver&quot;);</span><br><span class="line">        searchBox.submit();</span><br><span class="line"></span><br><span class="line">        Thread.sleep(3000);</span><br><span class="line">        driver.quit();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<h2 id="高效使用"><a href="#高效使用" class="headerlink" title="高效使用"></a>高效使用</h2><p>ChromeDriver 启动ChromeDriver服务器进程，并在调用退出时终止它。<br>在大型测试时每个测试都会创建一个ChromeDriver实例，这将会浪费大量时间。有两种方法可以解决这个问题：</p>
<h4 id="1-使用ChromeDriverService"><a href="#1-使用ChromeDriverService" class="headerlink" title="1. 使用ChromeDriverService"></a>1. 使用ChromeDriverService</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(BlockJUnit4ClassRunner.class)</span><br><span class="line">public class ChromeTest extends TestCase &#123;</span><br><span class="line"></span><br><span class="line">  private static ChromeDriverService service;</span><br><span class="line">  private WebDriver driver;</span><br><span class="line"></span><br><span class="line">  @BeforeClass</span><br><span class="line">  public static void createAndStartService() &#123;</span><br><span class="line">    service = new ChromeDriverService.Builder()</span><br><span class="line">        .usingDriverExecutable(new File(&quot;path/to/my/chromedriver&quot;))</span><br><span class="line">        .usingAnyFreePort()</span><br><span class="line">        .build();</span><br><span class="line">    service.start();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @AfterClass</span><br><span class="line">  public static void createAndStopService() &#123;</span><br><span class="line">    service.stop();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Before</span><br><span class="line">  public void createDriver() &#123;</span><br><span class="line">    driver = new RemoteWebDriver(service.getUrl(),</span><br><span class="line">        DesiredCapabilities.chrome());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @After</span><br><span class="line">  public void quitDriver() &#123;</span><br><span class="line">    driver.quit();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Test</span><br><span class="line">  public void testGoogleSearch() &#123;</span><br><span class="line">    driver.get(&quot;http://www.google.com&quot;);</span><br><span class="line">    // rest of the test...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="2-在运行测试之前单独启动ChromeDriver服务器，并使用Remote-WebDriver连接到它"><a href="#2-在运行测试之前单独启动ChromeDriver服务器，并使用Remote-WebDriver连接到它" class="headerlink" title="2. 在运行测试之前单独启动ChromeDriver服务器，并使用Remote WebDriver连接到它"></a>2. 在运行测试之前单独启动ChromeDriver服务器，并使用Remote WebDriver连接到它</h4><p>在控制台执行chromedriver（如果没有添加环境变量的话需要到对应目录下执行）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">F:\temp&gt;chromedriver</span><br><span class="line">Starting ChromeDriver 2.37.543627 (63642262d9fb93fb4ab52398be4286d844092a5e) on port 9515</span><br><span class="line">Only local connections are allowed.</span><br></pre></td></tr></table></figure>

<p>Java 代码:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws MalformedURLException &#123;</span><br><span class="line">    WebDriver driver = new RemoteWebDriver(new URL(&quot;http://127.0.0.1:9515&quot;), DesiredCapabilities.chrome());</span><br><span class="line"></span><br><span class="line">    driver.get(&quot;http://www.baidu.com&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/Redis/Spring-Data-Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Redis/Spring-Data-Redis/" class="post-title-link" itemprop="url">Spring-Data-Redis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-11-11 23:41:00" itemprop="dateCreated datePublished" datetime="2019-11-11T23:41:00+08:00">2019-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>515</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">   &lt;!-- redis配置 --&gt;</span><br><span class="line">&lt;!-- jedis pool配置 --&gt;</span><br><span class="line">&lt;bean id=&quot;jedisPoolConfig&quot; class=&quot;redis.clients.jedis.JedisPoolConfig&quot;&gt;</span><br><span class="line">	&lt;property name=&quot;maxTotal&quot; value=&quot;$&#123;redis.maxTotal&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;maxIdle&quot; value=&quot;$&#123;redis.maxIdle&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;maxWaitMillis&quot; value=&quot;$&#123;redis.maxWaitMillis&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;testOnBorrow&quot; value=&quot;$&#123;redis.testOnBorrow&#125;&quot; /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Jedis ConnectionFactory --&gt;</span><br><span class="line">&lt;bean id=&#x27;jedisConnectionFactory&#x27;</span><br><span class="line">	class=&#x27;org.springframework.data.redis.connection.jedis.JedisConnectionFactory&#x27;&gt;</span><br><span class="line">	&lt;property name=&quot;usePool&quot; value=&quot;true&quot;&gt;&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;hostName&quot; value=&quot;$&#123;redis.host&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;port&quot; value=&quot;$&#123;redis.port&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;password&quot; value=&quot;$&#123;redis.pass&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;timeout&quot; value=&quot;$&#123;redis.timeout&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;database&quot; value=&quot;$&#123;redis.default.db&#125;&quot;&gt;&lt;/property&gt;</span><br><span class="line">	&lt;constructor-arg index=&quot;0&quot; ref=&quot;jedisPoolConfig&quot; /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">   &lt;bean id=&quot;stringRedisTemplate&quot; class=&quot;org.springframework.data.redis.core.StringRedisTemplate&quot;&gt;</span><br><span class="line">       &lt;property name=&quot;connectionFactory&quot; ref=&quot;jedisConnectionFactory&quot; /&gt;</span><br><span class="line">   &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">   &lt;bean id=&quot;redisTemplate&quot; class=&quot;org.springframework.data.redis.core.RedisTemplate&quot;&gt;</span><br><span class="line">       &lt;property name=&quot;connectionFactory&quot; ref=&quot;jedisConnectionFactory&quot; /&gt;</span><br><span class="line">       &lt;property name=&quot;keySerializer&quot;&gt;</span><br><span class="line">           &lt;bean class=&quot;org.springframework.data.redis.serializer.StringRedisSerializer&quot; /&gt;</span><br><span class="line">       &lt;/property&gt;</span><br><span class="line">       &lt;property name=&quot;valueSerializer&quot;&gt;</span><br><span class="line">           &lt;bean class=&quot;com.xxx.xxx.xxx.redis.serializer.JsonRedisSerializer&quot; /&gt;</span><br><span class="line">       &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">       &lt;property name=&quot;hashKeySerializer&quot;&gt;</span><br><span class="line">           &lt;bean class=&quot;org.springframework.data.redis.serializer.StringRedisSerializer&quot; /&gt;</span><br><span class="line">       &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">       &lt;property name=&quot;hashValueSerializer&quot;&gt;</span><br><span class="line">           &lt;bean class=&quot;com.xxx.xxx.xxx.redis.serializer.JsonRedisSerializer&quot; /&gt;</span><br><span class="line">       &lt;/property&gt;</span><br><span class="line">   &lt;/bean&gt;</span><br></pre></td></tr></table></figure>


<p>序列化操作类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line">import org.springframework.data.redis.serializer.RedisSerializer;</span><br><span class="line">import org.springframework.data.redis.serializer.SerializationException;</span><br><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSON;</span><br><span class="line"></span><br><span class="line">public class JsonRedisSerializer implements RedisSerializer&lt;Object&gt; &#123;</span><br><span class="line"></span><br><span class="line">    private static final String CHARSET_NAME = &quot;UTF-8&quot;;</span><br><span class="line"></span><br><span class="line">    private static final Logger logger = LoggerFactory.getLogger(JsonRedisSerializer.class);</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public byte[] serialize(Object data) throws SerializationException &#123;</span><br><span class="line">        if (data == null) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            // 先转成String</span><br><span class="line">            String json = JSON.toJSONString(data);</span><br><span class="line">            // 包装</span><br><span class="line">            SerializerObject so = new SerializerObject();</span><br><span class="line">            so.setClassName(data.getClass().getName());</span><br><span class="line">            so.setJsonString(json);</span><br><span class="line">            // 再转</span><br><span class="line">            String serializerStr = JSON.toJSONString(so);</span><br><span class="line"></span><br><span class="line">            return serializerStr.getBytes(CHARSET_NAME);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            logger.error(&quot;RedisSerializer序列化异常&quot;, e);</span><br><span class="line">            throw new SerializationException(&quot;RedisSerializer序列化异常&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object deserialize(byte[] bytes) throws SerializationException &#123;</span><br><span class="line">        if (bytes == null) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            String serializerStr = new String(bytes, CHARSET_NAME);</span><br><span class="line">            SerializerObject deSerObj = JSON.parseObject(serializerStr, SerializerObject.class);</span><br><span class="line"></span><br><span class="line">            Class&lt;?&gt; t = Class.forName(deSerObj.getClassName());</span><br><span class="line">            return JSON.parseObject(deSerObj.getJsonString(), t);</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            logger.error(&quot;RedisSerializer反序列化异常&quot;, e);</span><br><span class="line">            throw new SerializationException(&quot;RedisSerializer反序列化异常&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class SerializerObject &#123;</span><br><span class="line">    private String className;</span><br><span class="line">    private String jsonString;</span><br><span class="line"></span><br><span class="line">    public String getClassName() &#123;</span><br><span class="line">        return className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setClassName(String className) &#123;</span><br><span class="line">        this.className = className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getJsonString() &#123;</span><br><span class="line">        return jsonString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setJsonString(String jsonString) &#123;</span><br><span class="line">        this.jsonString = jsonString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">@Service(&quot;redisService&quot;)</span><br><span class="line">public class RedisServiceImpl implements RedisService &#123;</span><br><span class="line"></span><br><span class="line">    @Resource(name = &quot;stringRedisTemplate&quot;)</span><br><span class="line">    private RedisTemplate&lt;String, String&gt; template;</span><br><span class="line"></span><br><span class="line">    @Resource(name = &quot;stringRedisTemplate&quot;)</span><br><span class="line">    private ListOperations&lt;String, String&gt; listOps;</span><br><span class="line"></span><br><span class="line">    @Resource(name = &quot;stringRedisTemplate&quot;)</span><br><span class="line">    private HashOperations&lt;String, String, String&gt; hashOps;</span><br><span class="line"></span><br><span class="line">    @Resource(name = &quot;stringRedisTemplate&quot;)</span><br><span class="line">    private SetOperations&lt;String, String&gt; setOps;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void delKey(String key) &#123;</span><br><span class="line">        template.delete(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean hasKey(String key) &#123;</span><br><span class="line">        return template.hasKey(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Long setAdd(String key, String... values) &#123;</span><br><span class="line">        return setOps.add(key, values);</span><br><span class="line">        // return template.boundSetOps(key).add(values);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Long setSize(String key) &#123;</span><br><span class="line">        return setOps.size(key);</span><br><span class="line">        // return template.boundSetOps(key).size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Long rightPushList(String key, String value) &#123;</span><br><span class="line">        return listOps.rightPush(key, value);</span><br><span class="line">        // return template.boundListOps(key).rightPush(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String leftPopList(String key) &#123;</span><br><span class="line">        return listOps.leftPop(key);</span><br><span class="line">        // return template.boundListOps(key).leftPop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Long listSize(String key) &#123;</span><br><span class="line">        return listOps.size(key);</span><br><span class="line">        // return template.boundListOps(key).size();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<hr>
<table>
<thead>
<tr>
<th>类</th>
<th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>ValueOperations</td>
<td>Redis String&#x2F;Value 操作</td>
</tr>
<tr>
<td>ListOperations</td>
<td>Redis List 操作</td>
</tr>
<tr>
<td>SetOperations</td>
<td>Redis Set 操作</td>
</tr>
<tr>
<td>ZSetOperations</td>
<td>Redis Sort Set 操作</td>
</tr>
<tr>
<td>HashOperations</td>
<td>Redis Hash 操作</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>类</th>
<th>约束</th>
</tr>
</thead>
<tbody><tr>
<td>BoundValueOperations</td>
<td>Redis String&#x2F;Value key 约束</td>
</tr>
<tr>
<td>BoundListOperations</td>
<td>Redis List key 约束</td>
</tr>
<tr>
<td>BoundSetOperations</td>
<td>Redis Set key 约束</td>
</tr>
<tr>
<td>BoundZSetOperations</td>
<td>Redis Sort Set key 约束</td>
</tr>
<tr>
<td>BoundHashOperations</td>
<td>Redis Hash key 约束</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/GPS/%E7%BB%8F%E7%BA%AC%E5%BA%A6%E5%9D%90%E6%A0%87%E5%B0%8F%E6%95%B0%E4%BD%8D%E4%B8%8E%E7%B2%BE%E5%BA%A6%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/GPS/%E7%BB%8F%E7%BA%AC%E5%BA%A6%E5%9D%90%E6%A0%87%E5%B0%8F%E6%95%B0%E4%BD%8D%E4%B8%8E%E7%B2%BE%E5%BA%A6%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/" class="post-title-link" itemprop="url">经纬度坐标小数位与精度的对应关系</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-10-16 00:00:00" itemprop="dateCreated datePublished" datetime="2019-10-16T00:00:00+08:00">2019-10-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/" itemprop="url" rel="index"><span itemprop="name">硬件与物联网</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/GPS/" itemprop="url" rel="index"><span itemprop="name">GPS</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>419</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="纬度不变-精度相差1的情况"><a href="#纬度不变-精度相差1的情况" class="headerlink" title="纬度不变 精度相差1的情况"></a>纬度不变 精度相差1的情况</h3><p>测试结果如下：</p>
<h4 id="小数点后6位，精度：0-1米"><a href="#小数点后6位，精度：0-1米" class="headerlink" title="小数点后6位，精度：0.1米"></a>小数点后6位，精度：0.1米</h4><p>0.10139558886691133</p>
<h4 id="小数点后5位，精度：1米"><a href="#小数点后5位，精度：1米" class="headerlink" title="小数点后5位，精度：1米"></a>小数点后5位，精度：1米</h4><p>1.0139558860891593</p>
<h4 id="小数点后4位，精度：10米"><a href="#小数点后4位，精度：10米" class="headerlink" title="小数点后4位，精度：10米"></a>小数点后4位，精度：10米</h4><p>10.139558845411655</p>
<h4 id="小数点后3位，精度：101米"><a href="#小数点后3位，精度：101米" class="headerlink" title="小数点后3位，精度：101米"></a>小数点后3位，精度：101米</h4><p>101.39558846680167</p>
<h4 id="小数点后3位（经纬度同时改变1），精度：150米"><a href="#小数点后3位（经纬度同时改变1），精度：150米" class="headerlink" title="小数点后3位（经纬度同时改变1），精度：150米"></a>小数点后3位（经纬度同时改变1），精度：150米</h4><p>150.4837860345681</p>
<h4 id="小数点后2位，精度：1014米"><a href="#小数点后2位，精度：1014米" class="headerlink" title="小数点后2位，精度：1014米"></a>小数点后2位，精度：1014米</h4><p>1013.9558844430293</p>
<h3 id="测试代码："><a href="#测试代码：" class="headerlink" title="测试代码："></a>测试代码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">public class DistanceCalcUtil &#123;</span><br><span class="line"></span><br><span class="line">    // 地球半径</span><br><span class="line">    private static final double EARTH_RADIUS = 6370996.81;</span><br><span class="line"></span><br><span class="line">    // 弧度</span><br><span class="line">    private static double radian(double d) &#123;</span><br><span class="line">        return d * Math.PI / 180.0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 计算两点之间的距离</span><br><span class="line">     * </span><br><span class="line">     * @param lat1</span><br><span class="line">     * @param lng1</span><br><span class="line">     * @param lat2</span><br><span class="line">     * @param lng2</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static double distanceOfTwoPoints(double lat1, double lng1, double lat2, double lng2) &#123;</span><br><span class="line">        double radLat1 = radian(lat1);</span><br><span class="line">        double radLat2 = radian(lat2);</span><br><span class="line">        double a = radLat1 - radLat2;</span><br><span class="line">        double b = radian(lng1) - radian(lng2);</span><br><span class="line">        double s = 2 * Math.asin(Math</span><br><span class="line">            .sqrt(Math.pow(Math.sin(a / 2), 2) + Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / 2), 2)));</span><br><span class="line">        s = s * EARTH_RADIUS;</span><br><span class="line">        return s;</span><br><span class="line">        // s = Math.round(s * 10000) / 10000;</span><br><span class="line">        // Integer distance = Integer.parseInt(new</span><br><span class="line">        // java.text.DecimalFormat(&quot;0&quot;).format(s));</span><br><span class="line">        // return distance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        System.out.println(&quot;经度改变1位，测试：&quot;);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;小数点后6位，精度：0.1米&quot;);</span><br><span class="line">        System.out.println(distanceOfTwoPoints(24.234532, 124.123223, 24.234532, 124.123224));</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;小数点后5位，精度：1米&quot;);</span><br><span class="line">        System.out.println(distanceOfTwoPoints(24.234532, 124.12322, 24.234532, 124.12323));</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;小数点后4位，精度：10米&quot;);</span><br><span class="line">        System.out.println(distanceOfTwoPoints(24.234532, 124.1232, 24.234532, 124.1233));</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;小数点后3位，精度：101米&quot;);</span><br><span class="line">        System.out.println(distanceOfTwoPoints(24.234532, 124.123, 24.234532, 124.124));</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;小数点后3位（经纬度同时改变1位），精度：150米&quot;);</span><br><span class="line">        System.out.println(distanceOfTwoPoints(24.234, 124.123, 24.235, 124.124));</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;小数点后2位，精度：1014米&quot;);</span><br><span class="line">        System.out.println(distanceOfTwoPoints(24.234532, 124.12, 24.234532, 124.13));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="保存全国的经纬度点3位小数"><a href="#保存全国的经纬度点3位小数" class="headerlink" title="保存全国的经纬度点3位小数"></a>保存全国的经纬度点3位小数</h3><p>在地图上测距，画一个大概覆盖全国的矩形</p>
<p>宽：4000000 米<br>高：2500000 米</p>
<p>换算成经纬度点，大概10亿个</p>
<p>初步估计保存全国的经纬度（小数点保留3位，精度约100米）大概需要保存10亿条记录</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/MySQL/mysql-workbench/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/MySQL/mysql-workbench/" class="post-title-link" itemprop="url">mysql-workbench</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-09-14 23:41:00" itemprop="dateCreated datePublished" datetime="2019-09-14T23:41:00+08:00">2019-09-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>39</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/workbench/">https://dev.mysql.com/downloads/workbench/</a></p>
<h2 id="VC-的包"><a href="#VC-的包" class="headerlink" title="VC++的包"></a>VC++的包</h2><p>安装提示缺少VC++的包</p>
<p><a target="_blank" rel="noopener" href="https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads">https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads</a></p>
<p><a target="_blank" rel="noopener" href="https://aka.ms/vs/16/release/vc_redist.x64.exe">https://aka.ms/vs/16/release/vc_redist.x64.exe</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E8%84%9A%E6%9C%AC/shell/%E5%BA%94%E7%94%A8%E5%90%AF%E5%81%9C%E8%84%9A%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E8%84%9A%E6%9C%AC/shell/%E5%BA%94%E7%94%A8%E5%90%AF%E5%81%9C%E8%84%9A%E6%9C%AC/" class="post-title-link" itemprop="url">应用启停脚本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-27 19:53:00" itemprop="dateCreated datePublished" datetime="2019-08-27T19:53:00+08:00">2019-08-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%84%9A%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">脚本</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%84%9A%E6%9C%AC/shell/" itemprop="url" rel="index"><span itemprop="name">shell</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>187</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>以SpringBoot 应用为例子</p>
<h3 id="startup-sh"><a href="#startup-sh" class="headerlink" title="startup.sh"></a>startup.sh</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">#</span><br><span class="line"># linux 下的启动脚本</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">#进入脚本目录</span><br><span class="line">cd `dirname $0`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 启动程序</span><br><span class="line">nohup java -Dspring.profiles.active=test -jar wwh-test-1.0-SNAPSHOT.jar &gt; wwh-test.out 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="shutdown-sh"><a href="#shutdown-sh" class="headerlink" title="shutdown.sh"></a>shutdown.sh</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 设置jar包名称通配符</span><br><span class="line">jar_pattern=&quot;wwh-test.*.jar&quot;</span><br><span class="line"></span><br><span class="line"># 查找正在运行的jar包的进程ID</span><br><span class="line">pids=$(ps -ef | grep &quot;$jar_pattern&quot; | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"># 如果找到正在运行的进程，就停止它</span><br><span class="line">if [ -n &quot;$pids&quot; ]; then</span><br><span class="line">    echo &quot;正在停止匹配 $jar_pattern 的进程...&quot;</span><br><span class="line">    for pid in $pids; do</span><br><span class="line">        echo &quot;停止进程 $pid&quot;</span><br><span class="line">        kill -15 &quot;$pid&quot;</span><br><span class="line">    done</span><br><span class="line"></span><br><span class="line">    # 循环检查进程是否已经停止</span><br><span class="line">    for pid in $pids; do</span><br><span class="line">        while kill -0 &quot;$pid&quot; &gt;/dev/null 2&gt;&amp;1; do</span><br><span class="line">            echo -n &quot;.&quot;</span><br><span class="line">            sleep 1</span><br><span class="line">        done</span><br><span class="line">        echo &quot;进程 $pid 已停止.&quot;</span><br><span class="line">    done</span><br><span class="line"></span><br><span class="line">    echo &quot;所有进程已停止.&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;未找到匹配 $jar_pattern 的进程.&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/java/sun.misc.Unsafe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/java/sun.misc.Unsafe/" class="post-title-link" itemprop="url">sun.misc.Unsafe</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-24 23:41:00" itemprop="dateCreated datePublished" datetime="2019-08-24T23:41:00+08:00">2019-08-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="sun-misc-Unsafe-简介"><a href="#sun-misc-Unsafe-简介" class="headerlink" title="sun.misc.Unsafe 简介"></a><code>sun.misc.Unsafe</code> 简介</h1><p><code>sun.misc.Unsafe</code> 是 Java 中的一个类，位于 <code>sun.misc</code> 包下。它提供了一组低级别的、不安全的操作，允许开发人员绕过 Java 的安全机制和内存管理，直接操作内存、对象、线程等。这使得它在某些高性能、低级别的编程中非常有用，但也非常危险。</p>
<h2 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h2><h3 id="1-直接内存访问："><a href="#1-直接内存访问：" class="headerlink" title="1. 直接内存访问："></a>1. 直接内存访问：</h3><ul>
<li>可以分配、释放和访问本机内存，类似于 C&#x2F;C++ 中的指针操作。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">memoryAddress</span> <span class="operator">=</span> unsafe.allocateMemory(size);</span><br><span class="line">unsafe.putInt(memoryAddress, <span class="number">42</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> unsafe.getInt(memoryAddress);</span><br><span class="line">unsafe.freeMemory(memoryAddress);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-对象操作："><a href="#2-对象操作：" class="headerlink" title="2. 对象操作："></a>2. 对象操作：</h3><ul>
<li>可以在不调用构造函数的情况下创建对象。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SomeClass</span> <span class="variable">instance</span> <span class="operator">=</span> (SomeClass) unsafe.allocateInstance(SomeClass.class);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-字段操作："><a href="#3-字段操作：" class="headerlink" title="3. 字段操作："></a>3. 字段操作：</h3><ul>
<li>可以直接修改对象的字段值，绕过 Java 的访问控制。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> SomeClass.class.getDeclaredField(<span class="string">&quot;someField&quot;</span>);</span><br><span class="line"><span class="type">long</span> <span class="variable">offset</span> <span class="operator">=</span> unsafe.objectFieldOffset(field);</span><br><span class="line">unsafe.putInt(instance, offset, <span class="number">42</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-CAS-操作："><a href="#4-CAS-操作：" class="headerlink" title="4. CAS 操作："></a>4. CAS 操作：</h3><ul>
<li>提供了 compare-and-swap（比较并交换）操作，用于实现无锁编程。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">boolean success = unsafe.compareAndSwapInt(someObject, offset, expectedValue, newValue);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-内存屏障："><a href="#5-内存屏障：" class="headerlink" title="5. 内存屏障："></a>5. 内存屏障：</h3><ul>
<li>提供了内存屏障操作，确保指令顺序不会因为 CPU 优化而打乱。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unsafe.fullFence();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="使用注意事项"><a href="#使用注意事项" class="headerlink" title="使用注意事项"></a>使用注意事项</h2><ul>
<li><strong>不安全性</strong>：由于它可以绕过 Java 的安全机制，错误使用可能导致程序崩溃、内存泄漏、数据损坏等问题。</li>
<li><strong>可移植性差</strong>：sun.misc.Unsafe 是 JDK 内部实现的一部分，不属于标准 Java API，因此不同的 JVM 实现中可能不兼容。</li>
<li><strong>受限访问</strong>：在 Java 9 及之后的版本中，直接访问 sun.misc.Unsafe 类变得更加困难，建议通过反射或者使用替代的 API（如 VarHandle）。</li>
</ul>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>以下是一个简单示例，展示如何使用 sun.misc.Unsafe 来分配和访问本机内存：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sun.misc.Unsafe;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnsafeExample</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Unsafe unsafe;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> Unsafe.class.getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            unsafe = (Unsafe) field.get(<span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">4</span>; <span class="comment">// 4 bytes</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">memoryAddress</span> <span class="operator">=</span> unsafe.allocateMemory(size);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            unsafe.putInt(memoryAddress, <span class="number">42</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> unsafe.getInt(memoryAddress);</span><br><span class="line">            System.out.println(<span class="string">&quot;Value: &quot;</span> + value); <span class="comment">// Output: Value: 42</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            unsafe.freeMemory(memoryAddress);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>使用 <code>sun.misc.Unsafe</code> 是危险的，因为它绕过了 Java 的类型安全检查和内存管理机制。如果使用不当，可能会导致严重的错误，如内存泄漏、数据损坏或程序崩溃。并且，由于它不是 Java 标准 API 的一部分，在不同的 Java 版本和运行环境中可能会有不同的表现，甚至可能不被支持。</p>
<hr>
<hr>
<p><a target="_blank" rel="noopener" href="http://mishadoff.com/blog/java-magic-part-4-sun-dot-misc-dot-unsafe/">http://mishadoff.com/blog/java-magic-part-4-sun-dot-misc-dot-unsafe/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//重新分配内存</span><br><span class="line">public native long reallocateMemory(long address, long bytes);  </span><br><span class="line">  </span><br><span class="line">//分配内存  </span><br><span class="line">public native long allocateMemory(long bytes);  </span><br><span class="line">  </span><br><span class="line">//释放内存  </span><br><span class="line">public native void freeMemory(long address);  </span><br><span class="line">  </span><br><span class="line">//在给定的内存块中设置值  </span><br><span class="line">public native void setMemory(Object o, long offset, long bytes, byte value);  </span><br><span class="line">  </span><br><span class="line">//从一个内存块拷贝到另一个内存块  </span><br><span class="line">public native void copyMemory(Object srcBase, long srcOffset, Object destBase, long destOffset, long bytes);  </span><br><span class="line">  </span><br><span class="line">//获取值，不管java的访问限制，其他有类似的getInt，getDouble，getLong，getChar等等  </span><br><span class="line">public native Object getObject(Object o, long offset);  </span><br><span class="line">  </span><br><span class="line">//设置值，不管java的访问限制，其他有类似的putInt,putDouble，putLong，putChar等等  </span><br><span class="line">public native void putObject(Object o, long offset);  </span><br><span class="line">  </span><br><span class="line">//从一个给定的内存地址获取本地指针，如果不是allocateMemory方法的，结果将不确定  </span><br><span class="line">public native long getAddress(long address);  </span><br><span class="line">  </span><br><span class="line">//存储一个本地指针到一个给定的内存地址,如果地址不是allocateMemory方法的，结果将不确定  </span><br><span class="line">public native void putAddress(long address, long x);  </span><br><span class="line">  </span><br><span class="line">//该方法返回给定field的内存地址偏移量，这个值对于给定的filed是唯一的且是固定不变的  </span><br><span class="line">public native long staticFieldOffset(Field f);  </span><br><span class="line">  </span><br><span class="line">//报告一个给定的字段的位置，不管这个字段是private，public还是保护类型，和staticFieldBase结合使用  </span><br><span class="line">public native long objectFieldOffset(Field f);  </span><br><span class="line">  </span><br><span class="line">//获取一个给定字段的位置  </span><br><span class="line">public native Object staticFieldBase(Field f);  </span><br><span class="line">  </span><br><span class="line">//确保给定class被初始化，这往往需要结合基类的静态域（field）  </span><br><span class="line">public native void ensureClassInitialized(Class c);  </span><br><span class="line">  </span><br><span class="line">//可以获取数组第一个元素的偏移地址  </span><br><span class="line">public native int arrayBaseOffset(Class arrayClass);  </span><br><span class="line">  </span><br><span class="line">//可以获取数组的转换因子，也就是数组中元素的增量地址。将arrayBaseOffset与arrayIndexScale配合使用， 可以定位数组中每个元素在内存中的位置  </span><br><span class="line">public native int arrayIndexScale(Class arrayClass);  </span><br><span class="line">  </span><br><span class="line">//获取本机内存的页数，这个值永远都是2的幂次方  </span><br><span class="line">public native int pageSize();  </span><br><span class="line">  </span><br><span class="line">//告诉虚拟机定义了一个没有安全检查的类，默认情况下这个类加载器和保护域来着调用者类  </span><br><span class="line">public native Class defineClass(String name, byte[] b, int off, int len, ClassLoader loader, ProtectionDomain protectionDomain);  </span><br><span class="line">  </span><br><span class="line">//定义一个类，但是不让它知道类加载器和系统字典  </span><br><span class="line">public native Class defineAnonymousClass(Class hostClass, byte[] data, Object[] cpPatches);  </span><br><span class="line">  </span><br><span class="line">//锁定对象，必须是没有被锁的</span><br><span class="line">public native void monitorEnter(Object o);  </span><br><span class="line">  </span><br><span class="line">//解锁对象  </span><br><span class="line">public native void monitorExit(Object o);  </span><br><span class="line">  </span><br><span class="line">//试图锁定对象，返回true或false是否锁定成功，如果锁定，必须用monitorExit解锁  </span><br><span class="line">public native boolean tryMonitorEnter(Object o);  </span><br><span class="line">  </span><br><span class="line">//引发异常，没有通知  </span><br><span class="line">public native void throwException(Throwable ee);  </span><br><span class="line">  </span><br><span class="line">//CAS，如果对象偏移量上的值=期待值，更新为x,返回true.否则false.类似的有compareAndSwapInt,compareAndSwapLong,compareAndSwapBoolean,compareAndSwapChar等等。  </span><br><span class="line">public final native boolean compareAndSwapObject(Object o, long offset,  Object expected, Object x);  </span><br><span class="line">  </span><br><span class="line">// 该方法获取对象中offset偏移地址对应的整型field的值,支持volatile load语义。类似的方法有getIntVolatile，getBooleanVolatile等等  </span><br><span class="line">public native Object getObjectVolatile(Object o, long offset);   </span><br><span class="line">  </span><br><span class="line">//线程调用该方法，线程将一直阻塞直到超时，或者是中断条件出现。  </span><br><span class="line">public native void park(boolean isAbsolute, long time);  </span><br><span class="line">  </span><br><span class="line">//终止挂起的线程，恢复正常.java.util.concurrent包中挂起操作都是在LockSupport类实现的，也正是使用这两个方法</span><br><span class="line">public native void unpark(Object thread);  </span><br><span class="line">  </span><br><span class="line">//获取系统在不同时间系统的负载情况  </span><br><span class="line">public native int getLoadAverage(double[] loadavg, int nelems);  </span><br><span class="line">  </span><br><span class="line">//创建一个类的实例，不需要调用它的构造函数、初使化代码、各种JVM安全检查以及其它的一些底层的东西。即使构造函数是私有，我们也可以通过这个方法创建它的实例,对于单例模式，简直是噩梦。 </span><br><span class="line">public native Object allocateInstance(Class cls) throws InstantiationException;  </span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">王某某</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">138k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">8:20</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  





</body>
</html>
