<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"wangwen135.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
<meta property="og:type" content="website">
<meta property="og:title" content="王某某的笔记">
<meta property="og:url" content="https://wangwen135.github.io/page/17/index.html">
<meta property="og:site_name" content="王某某的笔记">
<meta property="og:description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="王某某">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://wangwen135.github.io/page/17/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/17/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>王某某的笔记</title>
  







<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MBG120GJ9P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MBG120GJ9P');
</script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">王某某的笔记</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录我的编程之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="王某某"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">王某某</p>
  <div class="site-description" itemprop="description">这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">170</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">55</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">147</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/wangwen135" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wangwen135" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianshu.com/u/66c41e72644b" title="简  书 → https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;66c41e72644b" rel="noopener me" target="_blank"><i class="fa fa-link fa-fw"></i>简  书</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wangwen135@gmail.com" title="E-Mail → mailto:wangwen135@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/wangwen135" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;wangwen135" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/Spring%20Data%20Hbase/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/Spring%20Data%20Hbase/" class="post-title-link" itemprop="url">Spring Data Hbase</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-09-23 22:32:00" itemprop="dateCreated datePublished" datetime="2016-09-23T22:32:00+08:00">2016-09-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/" itemprop="url" rel="index"><span itemprop="name">HBase</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>545</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-hadoop/docs/current/reference/html/springandhadoop-hbase.html">https://docs.spring.io/spring-hadoop/docs/current/reference/html/springandhadoop-hbase.html</a></p>
<p>通过hbase-configuration命名空间元素（或其支持HbaseConfigurationFactoryBean）为HBase提供基本配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- default bean id is &#x27;hbaseConfiguration&#x27; that uses the existing &#x27;hadoopCconfiguration&#x27; object --&gt;</span><br><span class="line">&lt;hdp:hbase-configuration configuration-ref=&quot;hadoopCconfiguration&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>配置连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- delete associated connections but do not stop the proxies --&gt;</span><br><span class="line">&lt;hdp:hbase-configuration stop-proxy=&quot;false&quot; delete-connection=&quot;true&quot;&gt;</span><br><span class="line">  foo=bar</span><br><span class="line">  property=value</span><br><span class="line">&lt;/hdp:hbase-configuration&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- specify ZooKeeper host/port --&gt;</span><br><span class="line">&lt;hdp:hbase-configuration zk-quorum=&quot;$&#123;hbase.host&#125;&quot; zk-port=&quot;$&#123;hbase.port&#125;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>属性和配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;hdp:hbase-configuration properties-ref=&quot;some-props-bean&quot; properties-location=&quot;classpath:/conf/testing/hbase.properties&quot;/&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>核心HbaseTemplate–一个与HBase交互的高层次抽象。该模板需要HBase配置，一旦设置，该模板就是线程安全的，并且可以同时在多个实例中重用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// default HBase configuration</span><br><span class="line">&lt;hdp:hbase-configuration/&gt;</span><br><span class="line"></span><br><span class="line">// wire hbase configuration (using default name &#x27;hbaseConfiguration&#x27;) into the template</span><br><span class="line">&lt;bean id=&quot;htemplate&quot; class=&quot;org.springframework.data.hadoop.hbase.HbaseTemplate&quot; p:configuration-ref=&quot;hbaseConfiguration&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p>使用例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// writing to &#x27;MyTable&#x27;</span><br><span class="line">template.execute(&quot;MyTable&quot;, new TableCallback&lt;Object&gt;() &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public Object doInTable(HTable table) throws Throwable &#123;</span><br><span class="line">    Put p = new Put(Bytes.toBytes(&quot;SomeRow&quot;));</span><br><span class="line">    p.add(Bytes.toBytes(&quot;SomeColumn&quot;), Bytes.toBytes(&quot;SomeQualifier&quot;), Bytes.toBytes(&quot;AValue&quot;));</span><br><span class="line">    table.put(p);</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// read each row from &#x27;MyTable&#x27;</span><br><span class="line">List&lt;String&gt; rows = template.find(&quot;MyTable&quot;, &quot;SomeColumn&quot;, new RowMapper&lt;String&gt;() &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public String mapRow(Result result, int rowNum) throws Exception &#123;</span><br><span class="line">    return result.toString();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>


<p>配置文件例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;hdp:configuration id=&quot;hadoopConfiguration&quot;&gt;</span><br><span class="line">      fs.defaultFS=$&#123;spring.hadoop.fsUri&#125;</span><br><span class="line">      &lt;!-- hadoop.tmp.dir=/tmp/hadoop --&gt;</span><br><span class="line">  &lt;/hdp:configuration&gt;</span><br><span class="line"></span><br><span class="line">  &lt;hdp:file-system id=&quot;hadoopFs&quot; configuration-ref=&quot;hadoopConfiguration&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;hdp:hbase-configuration id=&quot;hbaseConfiguration&quot; configuration-ref=&quot;hadoopConfiguration&quot; zk-quorum=&quot;$&#123;hbase.zk.host&#125;&quot; zk-port=&quot;$&#123;hbase.zk.port&#125;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;hbaseTemplate&quot; class=&quot;org.springframework.data.hadoop.hbase.HbaseTemplate&quot;&gt;</span><br><span class="line">      &lt;property name=&quot;configuration&quot; ref=&quot;hbaseConfiguration&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 配置一个connectionfactory使用原生的API --&gt;</span><br><span class="line">  &lt;bean id=&#x27;hbaseConnection&#x27; class=&#x27;org.apache.hadoop.hbase.client.ConnectionFactory&#x27; factory-method=&quot;createConnection&quot; destroy-method=&quot;close&quot;&gt;</span><br><span class="line">      &lt;constructor-arg index=&quot;0&quot; ref=&quot;hbaseConfiguration&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Connection 说明：</strong><br>创建连接是一个重量级操作。连接实现是线程安全的，因此客户端可以创建一个连接，并与不同的线程共享它。Table和Admin实例是轻量级的，并且不是线程安全的。通常，每个客户端应用程序都实例化一个连接，每个线程都将获得自己的Table实例。不推荐使用Table和Admin的缓存或池。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class IconTableInit implements InitializingBean &#123;</span><br><span class="line"></span><br><span class="line">    private static Logger logger = LoggerFactory.getLogger(IconTableInit.class);</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private Connection connection;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void afterPropertiesSet() throws Exception &#123;</span><br><span class="line">        // 如果表不存在则创建表</span><br><span class="line">        Admin admin = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            admin = connection.getAdmin();</span><br><span class="line">            if (!admin.tableExists(TableName.valueOf(TABLE_NAME))) &#123;</span><br><span class="line"></span><br><span class="line">                logger.info(&quot;HBase中不存在&#123;&#125;表！&quot;, TABLE_NAME);</span><br><span class="line"></span><br><span class="line">                HTableDescriptor tableDescriptor = new HTableDescriptor(TableName.valueOf(TABLE_NAME));</span><br><span class="line">                HColumnDescriptor columnDescriptor = new HColumnDescriptor(CF_INFO_B);</span><br><span class="line">                tableDescriptor.addFamily(columnDescriptor);</span><br><span class="line">                admin.createTable(tableDescriptor);</span><br><span class="line"></span><br><span class="line">                logger.info(&quot;&#123;&#125;表创建成功！&quot;, TABLE_NAME);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            logger.error(&quot;系统启动时检查icon表是否创建异常！&quot;, e);</span><br><span class="line">            throw new GeneralException(&quot;#####  系统启动时连接HBase出现异常！ #####&quot;);</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (admin != null) &#123;</span><br><span class="line">                admin.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/HBase%201.2.4%20%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/HBase%201.2.4%20%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">HBase 1.2.4 安装配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-09-22 23:21:00" itemprop="dateCreated datePublished" datetime="2016-09-22T23:21:00+08:00">2016-09-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/" itemprop="url" rel="index"><span itemprop="name">HBase</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>925</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>官方网站：<br><a target="_blank" rel="noopener" href="http://hbase.apache.org/">http://hbase.apache.org/</a></p>
<p>文档：<br><a target="_blank" rel="noopener" href="http://hbase.apache.org/book.html">http://hbase.apache.org/book.html</a></p>
<h2 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h2><p>CentOS Linux release 7.2.1511 (Core)<br>Hadoop 2.7.2<br>java version “1.7.0_80”<br>hbase 1.2.4</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol>
<li>检查防火墙  </li>
<li>检查SSH免密码登录  </li>
<li>检查&#x2F;etc&#x2F;hosts  </li>
<li>检查各个服务器的JDK  </li>
<li>还应该注意各个服务器时间同步</li>
</ol>
<h2 id="部署结构"><a href="#部署结构" class="headerlink" title="部署结构"></a>部署结构</h2><table>
<thead>
<tr>
<th>Node Name</th>
<th>Master</th>
<th>ZooKeeper</th>
<th>RegionServer</th>
</tr>
</thead>
<tbody><tr>
<td>wwh213</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td>wwh214</td>
<td>backup</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>wwh215</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
</tr>
</tbody></table>
<hr>
<h4 id="etc-hosts-配置"><a href="#etc-hosts-配置" class="headerlink" title="&#x2F;etc&#x2F;hosts 配置"></a>&#x2F;etc&#x2F;hosts 配置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.1.213    wwh213</span><br><span class="line">192.168.1.214    wwh214</span><br><span class="line">192.168.1.215    wwh215</span><br></pre></td></tr></table></figure>

<h4 id="修改limit限制"><a href="#修改limit限制" class="headerlink" title="修改limit限制"></a>修改limit限制</h4><p>HBase 会在同一时间打开大量的文件句柄和进程，超过 Linux 的默认限制，导致可能会出现如下错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2010-04-06 03:04:37,542 INFO org.apache.hadoop.hdfs.DFSClient: Exception increateBlockOutputStream java.io.EOFException</span><br><span class="line">2010-04-06 03:04:37,542 INFO org.apache.hadoop.hdfs.DFSClient: Abandoning block blk_-6935524980745310745_1391901</span><br></pre></td></tr></table></figure>

<p>修改之前先查看一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ulimit -n -u</span><br><span class="line">open files                      (-n) 1024</span><br><span class="line">max user processes              (-u) 7274</span><br></pre></td></tr></table></figure>

<p>以root用户编辑文件：&#x2F;etc&#x2F;security&#x2F;limits.conf</p>
<p>在末尾加上:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop  -       nofile  32768</span><br><span class="line">hadoop  -       nproc   32000</span><br></pre></td></tr></table></figure>
<p>退出shell重新进入后生效</p>
<p>切换到hadoop用户</p>
<p>再次查看：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ulimit -n -u</span><br><span class="line">open files                      (-n) 32768</span><br><span class="line">max user processes              (-u) 32000</span><br></pre></td></tr></table></figure>

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="下载解压"><a href="#下载解压" class="headerlink" title="下载解压"></a>下载解压</h3><p>选择一个合适的目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://apache.fayea.com/hbase/1.2.4/hbase-1.2.4-bin.tar.gz</span><br><span class="line"></span><br><span class="line">tar -zxvf hbase-1.2.4-bin.tar.gz </span><br></pre></td></tr></table></figure>

<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h4 id="conf-hbase-env-sh"><a href="#conf-hbase-env-sh" class="headerlink" title="conf&#x2F;hbase-env.sh"></a>conf&#x2F;hbase-env.sh</h4><pre><code>对于HBase 0.98.5和更高版本，需要在启动HBase之前设置JAVA_HOME环境变量  

export JAVA_HOME=/usr/java/jdk1.7.0_80

假定集群的每个节点使用相同的配置。如果不是这样，您需要为每个节点单独设置JAVA_HOME。
</code></pre>
<p><em>这个环境变量设置不是必须的</em></p>
<p>告诉HBase是否应该管理自己的Zookeeper实例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export HBASE_MANAGES_ZK=false</span><br></pre></td></tr></table></figure>
<blockquote>
<p>自带的 Zookeeper 如不用，可删除</p>
</blockquote>
<p>设置PID文件存储路径，缺省是在&#x2F;tmp 下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export HBASE_PID_DIR=/data/hbase/tmp/pids</span><br></pre></td></tr></table></figure>

<p>使用JDK8 ，需要在HBase的配置文件中hbase-env.sh，注释掉两行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Configure PermSize. Only needed in JDK7. You can safely remove it for JDK8+</span><br><span class="line">export HBASE_MASTER_OPTS=&quot;$HBASE_MASTER_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m&quot;</span><br><span class="line">export HBASE_REGIONSERVER_OPTS=&quot;$HBASE_REGIONSERVER_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m&quot;</span><br></pre></td></tr></table></figure>

<h4 id="conf-hbase-site-xml"><a href="#conf-hbase-site-xml" class="headerlink" title="conf&#x2F;hbase-site.xml"></a>conf&#x2F;hbase-site.xml</h4><p>这是HBase的主配置文件<br>缺省配置：<a target="_blank" rel="noopener" href="http://hbase.apache.org/book.html#hbase_default_configurations">http://hbase.apache.org/book.html#hbase_default_configurations</a></p>
<p>配置本地临时目录，缺省值是’&#x2F;tmp’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hbase.tmp.dir&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;/data/hbase/tmp&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p>指定分布式运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p>配置hbase目录指到HDFS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hbase.rootdir&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;hdfs://192.168.1.213:9900/hbase&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：<br>$HBASE_HOME&#x2F;conf&#x2F;hbase-site.xml 的 hbase.rootdir的主机和端口号与$HADOOP_HOME&#x2F;conf&#x2F;core-site.xml 的 fs.default.name的主机和端口号一致</p>
</blockquote>
<p>配置Zookeeper  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;wwh213,wwh214,wwh215&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h5 id="conf-regionservers"><a href="#conf-regionservers" class="headerlink" title="conf&#x2F;regionservers"></a>conf&#x2F;regionservers</h5><p>配置RegionServer，删除之前的 &#x3D;&#x3D;localhost&#x3D;&#x3D; ，增加主机名或者IP。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wwh214</span><br><span class="line">wwh215</span><br></pre></td></tr></table></figure>

<h5 id="配置-backup-master"><a href="#配置-backup-master" class="headerlink" title="配置 backup master"></a>配置 backup master</h5><p>创建一个新的文件<strong>conf&#x2F;backup-masters</strong>，并添加一个主机名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;wwh214&#x27; &gt; backup-masters</span><br><span class="line"></span><br><span class="line">wwh214</span><br></pre></td></tr></table></figure>

<h5 id="复制hbase到其他节点"><a href="#复制hbase到其他节点" class="headerlink" title="复制hbase到其他节点"></a>复制hbase到其他节点</h5><p>集群中的节点都需要相同的配置信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp -r hbase-1.2.4 wwh214:/data/hbase/</span><br><span class="line"></span><br><span class="line">scp -r hbase-1.2.4 wwh215:/data/hbase/</span><br></pre></td></tr></table></figure>

<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>确保Zookeeper是启动状态的<br>随便找一台有hbase的节点，启动即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/start-hbase.sh</span><br></pre></td></tr></table></figure>
<p>输出信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">starting master, logging to /data/hbase/hbase-1.2.4/bin/../logs/hbase-hadoop-master-wwh213.out</span><br><span class="line">wwh215: starting regionserver, logging to /data/hbase/hbase-1.2.4/bin/../logs/hbase-hadoop-regionserver-wwh215.out</span><br><span class="line">wwh214: starting regionserver, logging to /data/hbase/hbase-1.2.4/bin/../logs/hbase-hadoop-regionserver-wwh214.out</span><br><span class="line">wwh214: starting master, logging to /data/hbase/hbase-1.2.4/bin/../logs/hbase-hadoop-master-wwh214.out</span><br></pre></td></tr></table></figure>

<h2 id="检查"><a href="#检查" class="headerlink" title="检查"></a>检查</h2><ol>
<li><p>检查Java进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ JPS  </span><br><span class="line"></span><br><span class="line">xxxxx HMaster</span><br><span class="line">xxxxx HRegionServer</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查HDFS中的HBase目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ bin/hadoop fs -ls /hbase</span><br><span class="line">Found 7 items</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2016-11-09 16:00 /hbase/.tmp</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2016-11-09 16:00 /hbase/MasterProcWALs</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2016-11-09 16:00 /hbase/WALs</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2016-11-09 16:00 /hbase/data</span><br><span class="line">-rw-r--r--   3 hadoop supergroup         42 2016-11-09 15:59 /hbase/hbase.id</span><br><span class="line">-rw-r--r--   3 hadoop supergroup          7 2016-11-09 15:59 /hbase/hbase.version</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2016-11-09 15:59 /hbase/oldWALs</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 HBase Shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ bin/hbase shell</span><br><span class="line">.....</span><br><span class="line">.....</span><br><span class="line">hbase(main):001:0&gt; </span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Web-UI"><a href="#Web-UI" class="headerlink" title="Web UI"></a>Web UI</h2><p>HBase的Web界面，现在的端口为16010，原来是60010.<br><a target="_blank" rel="noopener" href="http://192.168.1.213:16010/">http://192.168.1.213:16010</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/HBase%20Shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/HBase%20Shell/" class="post-title-link" itemprop="url">HBase Shell</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-09-22 14:49:00" itemprop="dateCreated datePublished" datetime="2016-09-22T14:49:00+08:00">2016-09-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/HBase/" itemprop="url" rel="index"><span itemprop="name">HBase</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>364</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ./bin/hbase shell</span><br><span class="line">hbase(main):001:0&gt;</span><br></pre></td></tr></table></figure>
<p>输入help 显示帮助信息</p>
<h4 id="1-创建表"><a href="#1-创建表" class="headerlink" title="1. 创建表"></a>1. 创建表</h4><p>使用 <strong>create</strong> 命令创建表，指定表名和列族名称</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):001:0&gt; create &#x27;test&#x27;, &#x27;cf&#x27;</span><br><span class="line">0 row(s) in 0.4170 seconds</span><br><span class="line"></span><br><span class="line">=&gt; Hbase::Table - test</span><br></pre></td></tr></table></figure>

<h4 id="2-查看表"><a href="#2-查看表" class="headerlink" title="2. 查看表"></a>2. 查看表</h4><p>使用 <strong>list</strong> 查看表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):002:0&gt; list &#x27;test&#x27;</span><br><span class="line">TABLE</span><br><span class="line">test</span><br><span class="line">1 row(s) in 0.0180 seconds</span><br><span class="line"></span><br><span class="line">=&gt; [&quot;test&quot;]</span><br></pre></td></tr></table></figure>

<h4 id="3-放数据到表中"><a href="#3-放数据到表中" class="headerlink" title="3. 放数据到表中"></a>3. 放数据到表中</h4><p>使用 <strong>put</strong> 命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):003:0&gt; put &#x27;test&#x27;, &#x27;row1&#x27;, &#x27;cf:a&#x27;, &#x27;value1&#x27;</span><br><span class="line">0 row(s) in 0.0850 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):004:0&gt; put &#x27;test&#x27;, &#x27;row2&#x27;, &#x27;cf:b&#x27;, &#x27;value2&#x27;</span><br><span class="line">0 row(s) in 0.0110 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):005:0&gt; put &#x27;test&#x27;, &#x27;row3&#x27;, &#x27;cf:c&#x27;, &#x27;value3&#x27;</span><br><span class="line">0 row(s) in 0.0100 seconds</span><br></pre></td></tr></table></figure>

<h4 id="4-扫描表中的数据"><a href="#4-扫描表中的数据" class="headerlink" title="4. 扫描表中的数据"></a>4. 扫描表中的数据</h4><p>使用 <strong>scan</strong> 命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):006:0&gt; scan &#x27;test&#x27;</span><br><span class="line">ROW                                      COLUMN+CELL</span><br><span class="line"> row1                                    column=cf:a, timestamp=1421762485768, value=value1</span><br><span class="line"> row2                                    column=cf:b, timestamp=1421762491785, value=value2</span><br><span class="line"> row3                                    column=cf:c, timestamp=1421762496210, value=value3</span><br><span class="line">3 row(s) in 0.0230 seconds</span><br></pre></td></tr></table></figure>
<p>使用 limit 限制返回结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#x27;test&#x27; ,&#123;&#x27;LIMIT&#x27; =&gt; 5&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-获取单行数据"><a href="#5-获取单行数据" class="headerlink" title="5. 获取单行数据"></a>5. 获取单行数据</h4><p>使用 <strong>get</strong> 命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):007:0&gt; get &#x27;test&#x27;, &#x27;row1&#x27;</span><br><span class="line">COLUMN                                   CELL</span><br><span class="line"> cf:a                                    timestamp=1421762485768, value=value1</span><br><span class="line">1 row(s) in 0.0350 seconds</span><br></pre></td></tr></table></figure>

<h4 id="6-禁用表"><a href="#6-禁用表" class="headerlink" title="6. 禁用表"></a>6. 禁用表</h4><p>如果要删除表或更改其设置，以及在某些其他情况下，需要先使用 <strong>disable</strong> 命令禁用表。你可以使用 <strong>enable</strong> 命令重新启用它。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):008:0&gt; disable &#x27;test&#x27;</span><br><span class="line">0 row(s) in 1.1820 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):009:0&gt; enable &#x27;test&#x27;</span><br><span class="line">0 row(s) in 0.1770 seconds</span><br></pre></td></tr></table></figure>

<h4 id="7-删除表"><a href="#7-删除表" class="headerlink" title="7. 删除表"></a>7. 删除表</h4><p>使用 <strong>drop</strong> 命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):011:0&gt; drop &#x27;test&#x27;</span><br><span class="line">0 row(s) in 0.1370 seconds</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="高级操作"><a href="#高级操作" class="headerlink" title="高级操作"></a>高级操作</h2><h4 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h4><p>指定起始行 和 终止行，并指定返回的列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scan &#x27;downloads&#x27;, &#123;STARTROW =&gt; &#x27;nare7pqnmojs2pg.onion&#x27; , ENDROW=&gt; &#x27;nare7pqnmojs2pg.onionz&#x27;,COLUMN=&gt;[&#x27;cf1:url&#x27;]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scan &#x27;downloads&#x27;, &#123;STARTROW =&gt; &#x27;nare7&#x27; , ENDROW=&gt; &#x27;nare7z&#x27;,COLUMN=&gt;[&#x27;cf1:url&#x27;]&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/Hadoop%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/Hadoop%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">Hadoop使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-09-20 23:21:00" itemprop="dateCreated datePublished" datetime="2016-09-20T23:21:00+08:00">2016-09-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/" itemprop="url" rel="index"><span itemprop="name">Hadoop</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h2><h4 id="Apache-Hadoop-2-7-2-文档"><a href="#Apache-Hadoop-2-7-2-文档" class="headerlink" title="Apache Hadoop 2.7.2 文档"></a>Apache Hadoop 2.7.2 文档</h4><p><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/stable/index.html">http://hadoop.apache.org/docs/stable/index.html</a></p>
<h4 id="中文文档"><a href="#中文文档" class="headerlink" title="中文文档"></a>中文文档</h4><p>比较老的，应该对照最新的文档看</p>
<h5 id="命令手册"><a href="#命令手册" class="headerlink" title="命令手册"></a>命令手册</h5><p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/r1.0.4/cn/commands_manual.html">https://hadoop.apache.org/docs/r1.0.4/cn/commands_manual.html</a></p>
<h5 id="Hadoop-Shell命令"><a href="#Hadoop-Shell命令" class="headerlink" title="Hadoop Shell命令"></a>Hadoop Shell命令</h5><p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/r1.0.4/cn/hdfs_shell.html">https://hadoop.apache.org/docs/r1.0.4/cn/hdfs_shell.html</a></p>
<h2 id="Hadoop命令"><a href="#Hadoop命令" class="headerlink" title="Hadoop命令"></a>Hadoop命令</h2><hr>
<p><strong>这些是从比较老的文档中复制的！</strong></p>
<hr>
<p>所有的hadoop命令均由bin&#x2F;hadoop脚本引发。不指定参数运行hadoop脚本会打印所有命令的描述。</p>
<p>用法：hadoop [–config confdir] [COMMAND] [GENERIC_OPTIONS] [COMMAND_OPTIONS]</p>
<p>Hadoop有一个选项解析框架用于解析一般的选项和运行类。</p>
<table>
<thead>
<tr>
<th>命令选项</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>–config confdir</td>
<td>覆盖缺省配置目录。缺省是${HADOOP_HOME}&#x2F;conf。</td>
</tr>
<tr>
<td>GENERIC_OPTIONS</td>
<td>多个命令都支持的通用选项。</td>
</tr>
<tr>
<td>COMMAND 命令选项S</td>
<td>各种各样的命令和它们的选项会在下面提到。这些命令被分为 用户命令 管理命令两组。</td>
</tr>
</tbody></table>
<p><strong>常规选项</strong><br>下面的选项被 dfsadmin, fs, fsck和 job支持。 应用程序要实现 Tool来支持 常规选项。</p>
<table>
<thead>
<tr>
<th>常规选项</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-conf <configuration file></td>
<td>指定应用程序的配置文件。</td>
</tr>
<tr>
<td>-D &lt;property&#x3D;value&gt;</td>
<td>为指定property指定值value。</td>
</tr>
<tr>
<td>-fs &lt;local | namenode:port&gt;</td>
<td>指定namenode。</td>
</tr>
<tr>
<td>-jt &lt;local | jobtracker:port&gt;</td>
<td>指定job tracker。只适用于job。</td>
</tr>
<tr>
<td>-files &lt;逗号分隔的文件列表&gt;</td>
<td>指定要拷贝到map reduce集群的文件的逗号分隔的列表。 只适用于job。</td>
</tr>
<tr>
<td>-libjars &lt;逗号分隔的jar列表&gt;</td>
<td>指定要包含到classpath中的jar文件的逗号分隔的列表。 只适用于job。</td>
</tr>
<tr>
<td>-archives &lt;逗号分隔的archive列表&gt;</td>
<td>指定要被解压到计算节点上的档案文件的逗号分割的列表。 只适用于job。</td>
</tr>
</tbody></table>
<p><strong>命令主要分为两类：</strong>  </p>
<hr>
<table>
<thead>
<tr>
<th>用户命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>archive</td>
<td>创建一个hadoop档案文件</td>
</tr>
<tr>
<td>distcp</td>
<td>递归地拷贝文件或目录</td>
</tr>
<tr>
<td>fs</td>
<td>运行一个常规的文件系统客户端</td>
</tr>
<tr>
<td>fsck</td>
<td>运行HDFS文件系统检查工具</td>
</tr>
<tr>
<td>jar</td>
<td>运行jar文件。用户可以把他们的Map Reduce代码捆绑到jar文件中，使用这个命令执行</td>
</tr>
<tr>
<td>job</td>
<td>用于和Map Reduce作业交互和命令</td>
</tr>
<tr>
<td>pipes</td>
<td>运行pipes作业</td>
</tr>
<tr>
<td>version</td>
<td>打印版本信息</td>
</tr>
<tr>
<td>CLASSNAME</td>
<td>hadoop脚本可用于调调用任何类</td>
</tr>
</tbody></table>
<hr>
<table>
<thead>
<tr>
<th>管理命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>balancer</td>
<td>运行集群平衡工具。管理员可以简单的按Ctrl-C来停止平衡过程</td>
</tr>
<tr>
<td>daemonlog</td>
<td>获取或设置每个守护进程的日志级别</td>
</tr>
<tr>
<td>datanode</td>
<td>运行一个HDFS的datanode</td>
</tr>
<tr>
<td>dfsadmin</td>
<td>运行一个HDFS的dfsadmin客户端</td>
</tr>
<tr>
<td>jobtracker</td>
<td>运行MapReduce job Tracker节点</td>
</tr>
<tr>
<td>namenode</td>
<td>运行namenode。有关升级，回滚，升级</td>
</tr>
<tr>
<td>secondarynamenode</td>
<td>运行HDFS的secondary namenode</td>
</tr>
<tr>
<td>tasktracker</td>
<td>运行MapReduce的task Tracker节点</td>
</tr>
</tbody></table>
<hr>
<h2 id="Hadoop-Shell命令-1"><a href="#Hadoop-Shell命令-1" class="headerlink" title="Hadoop Shell命令"></a>Hadoop Shell命令</h2><p>调用文件系统(FS)Shell命令应使用 bin&#x2F;hadoop fs <args>的形式。 所有的的FS shell命令使用URI路径作为参数。URI格式是scheme:&#x2F;&#x2F;authority&#x2F;path。对HDFS文件系统，scheme是hdfs，对本地文件系统，scheme是file。其中scheme和authority参数都是可选的，如果未加指定，就会使用配置中指定的默认scheme。一个HDFS文件或目录比如&#x2F;parent&#x2F;child可以表示成hdfs:&#x2F;&#x2F;namenode:namenodeport&#x2F;parent&#x2F;child，或者更简单的&#x2F;parent&#x2F;child（假设你配置文件中的默认值是namenode:namenodeport）。大多数FS Shell命令的行为和对应的Unix Shell命令类似，不同之处会在下面介绍各命令使用详情时指出。出错信息会输出到stderr，其他信息输出到stdout。</p>
<hr>
<p><strong>下面这些是结合新旧文档写的！并且经过测试</strong></p>
<p>Hadoop 2.7.2 中推荐使用<strong>hdfs dfs</strong> </p>
<p>查看命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hdfs dfs -help</span><br></pre></td></tr></table></figure>
<p>查看命令详情</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hdfs dfs -help command-name </span><br></pre></td></tr></table></figure>

<hr>
<h3 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -mkdir <paths>   </p>
</blockquote>
<p>接收路径的URI作为参数，并创建目录。</p>
<p>参数：</p>
<blockquote>
<p>-p 创建沿路径的各级父目录  </p>
</blockquote>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mkdir /user/hadoop/dir1 /user/hadoop/dir2</span><br><span class="line">hadoop fs -mkdir hdfs://nn1.example.com/user/hadoop/dir hdfs://nn2.example.com/user/hadoop/dir</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./hadoop fs -mkdir /wwh</span><br><span class="line">./hadoop fs -mkdir -p /user/hadoop/dir1</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -ls [-d] [-h] [-R] <args></p>
</blockquote>
<p>列出文件和目录。</p>
<p>参数：</p>
<blockquote>
<p>-d: 只列目录<br>-h: 格式化大小为人类可读的形式<br>-R: 递归子目录</p>
</blockquote>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -ls /user/hadoop/file1</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@wwh213 bin]# ./hadoop fs -ls /</span><br><span class="line">Found 3 items</span><br><span class="line">drwxr-xr-x   - root supergroup          0 2016-09-19 20:42 /user</span><br><span class="line">drwxr-xr-x   - root supergroup          0 2016-09-19 20:42 /wwh</span><br><span class="line">-rw-r--r--   2 root supergroup        818 2016-09-19 20:43 /测试文件.txt</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="put"><a href="#put" class="headerlink" title="put"></a>put</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -put <localsrc> … <dst>  </p>
</blockquote>
<p>从本地文件系统中复制单个或多个源路径到目标文件系统。也支持从标准输入中读取输入写入目标文件系统。  </p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -put localfile /user/hadoop/hadoopfile</span><br><span class="line">hadoop fs -put localfile1 localfile2 /user/hadoop/hadoopdir</span><br><span class="line">hadoop fs -put localfile hdfs://host:port/hadoop/hadoopfile</span><br><span class="line">hadoop fs -put - hdfs://host:port/hadoop/hadoopfile </span><br><span class="line">从标准输入中读取输入。</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./hadoop fs -put /tmp/测试文件.txt /</span><br><span class="line"></span><br><span class="line">./hadoop fs -put - /input.txt</span><br><span class="line"># CTRL+D 结束输入</span><br></pre></td></tr></table></figure>

<h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -cat URI [URI …]</p>
</blockquote>
<p>将路径指定文件的内容输出到stdout。</p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -cat hdfs://nn1.example.com/file1 hdfs://nn2.example.com/file2</span><br><span class="line">hadoop fs -cat file:///file3 /user/hadoop/file4</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hadoop fs -cat /input.txt</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="get"><a href="#get" class="headerlink" title="get"></a>get</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -get [-ignorecrc] [-crc] <src> <localdst></p>
</blockquote>
<p>复制文件到本地文件系统</p>
<p>参数：</p>
<blockquote>
<p>-ignorecrc 可以复制CRC校验失败的文件<br>-crc 选择可以复制文件和 CRC信息 </p>
</blockquote>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -get /user/hadoop/file localfile</span><br><span class="line">hadoop fs -get hdfs://nn.example.com/user/hadoop/file localfile</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@wwh213 bin]# ./hadoop fs -get /测试文件.txt /home</span><br><span class="line">[root@wwh213 bin]# </span><br></pre></td></tr></table></figure>

<h3 id="df"><a href="#df" class="headerlink" title="df"></a>df</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -df [-h] URI [URI …]</p>
</blockquote>
<p>显示空闲空间  </p>
<p>参数：</p>
<blockquote>
<p>-h 将大小格式化成人类可读的形式</p>
</blockquote>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop dfs -df /user/hadoop/dir1</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#不再推荐的</span><br><span class="line">./hadoop dfs -df /</span><br><span class="line">DEPRECATED: Use of this script to execute hdfs command is deprecated.</span><br><span class="line">Instead use the hdfs command for it.</span><br><span class="line"></span><br><span class="line">Filesystem                        Size   Used   Available  Use%</span><br><span class="line">hdfs://192.168.1.213:9900  14298382336  32768  7656443904    0%</span><br><span class="line"></span><br><span class="line">#推荐的形式</span><br><span class="line">./hdfs dfs -df</span><br><span class="line">Filesystem                        Size   Used   Available  Use%</span><br><span class="line">hdfs://192.168.1.213:9900  14298382336  32768  7658508288    0%</span><br><span class="line"></span><br><span class="line">#-h选项</span><br><span class="line"> ./hdfs dfs -df -h</span><br><span class="line">Filesystem                   Size  Used  Available  Use%</span><br><span class="line">hdfs://192.168.1.213:9900  13.3 G  32 K      7.1 G    0%</span><br></pre></td></tr></table></figure>

<h3 id="du"><a href="#du" class="headerlink" title="du"></a>du</h3><p>使用方法：</p>
<blockquote>
<p>hadoop fs -du [-s] [-h] URI [URI …]</p>
</blockquote>
<p>显示目录中所有文件的大小，或者当只指定一个文件时，显示此文件的大小。</p>
<p>参数：</p>
<blockquote>
<p>-s 显示总大小<br>-h 格式化大小为人类可读的形式</p>
</blockquote>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -du /user/hadoop/dir1 /user/hadoop/file1 hdfs://nn.example.com/user/hadoop/dir1</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./hadoop fs -du /</span><br><span class="line">192  /input.txt</span><br><span class="line">0    /user</span><br><span class="line">275  /wwh</span><br><span class="line">818  /测试文件.txt</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Hadoop-WebHDFS"><a href="#Hadoop-WebHDFS" class="headerlink" title="Hadoop WebHDFS"></a>Hadoop WebHDFS</h2><h3 id="WebHDFS-REST-API"><a href="#WebHDFS-REST-API" class="headerlink" title="WebHDFS REST API"></a>WebHDFS REST API</h3><p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/WebHDFS.html">https://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/WebHDFS.html</a></p>
<p>直接用这个地址可以通过web浏览文件</p>
<p><a target="_blank" rel="noopener" href="http://192.168.1.213:50070/explorer.html#/">http://192.168.1.213:50070/explorer.html#/</a></p>
<hr>
<h2 id="Hadoop-API"><a href="#Hadoop-API" class="headerlink" title="Hadoop API"></a>Hadoop API</h2><h3 id="java-API"><a href="#java-API" class="headerlink" title="java API"></a>java API</h3><p>通过java API 对文件进行操作</p>
<p>Apache Hadoop Main 2.7.2 API<br><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/r2.7.2/api/index.html">https://hadoop.apache.org/docs/r2.7.2/api/index.html</a></p>
<ol>
<li>创建一个简单的Maven工程</li>
<li>将JDK版本改到1.7<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">	&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;3.1&lt;/version&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">		&lt;source&gt;1.7&lt;/source&gt;</span><br><span class="line">		&lt;target&gt;1.7&lt;/target&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure></li>
<li>添加Hadoop-client依赖<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;2.7.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li>
<li>查看文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String uri = &quot;hdfs://192.168.1.213:9900/&quot;; // hdfs 地址</span><br><span class="line">Configuration conf = new Configuration();</span><br><span class="line">FileSystem fs = FileSystem.get(URI.create(uri), conf);</span><br><span class="line">Path path = new Path(&quot;/&quot;);</span><br><span class="line">FileStatus[] fileStatus = fs.listStatus(path);</span><br><span class="line">for (FileStatus file : fileStatus) &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>读写文件  <blockquote>
<p>权限问题解决：</p>
<blockquote>
<ul>
<li>修改 hdfs-core.xml 中的 dfs.permissions 配置项为false</li>
<li>通过hadoop shell 命令修改目录权限为 777</li>
<li>在客户端配置环境变量 HADOOP_USER_NAME&#x3D;root</li>
</ul>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">String uri = &quot;hdfs://192.168.1.213:9900/&quot;; // hdfs 地址</span><br><span class="line">String writeFile = &quot;/hello.txt&quot;;</span><br><span class="line">// 设置一个环境变量</span><br><span class="line">System.setProperty(&quot;HADOOP_USER_NAME&quot;, &quot;root&quot;);</span><br><span class="line"></span><br><span class="line">Configuration conf = new Configuration();</span><br><span class="line">FileSystem fs = FileSystem.get(URI.create(uri), conf);</span><br><span class="line">Path path = new Path(writeFile);</span><br><span class="line"></span><br><span class="line">FSDataOutputStream fsdos = fs.create(path);</span><br><span class="line">...写内容...</span><br><span class="line">fsdos.close();</span><br><span class="line"></span><br><span class="line">FSDataInputStream fsdis = fs.open(path);</span><br><span class="line">...读内容...</span><br><span class="line">fsdis.close();</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/Hadoop%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/Hadoop%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">Hadoop默认配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-09-14 13:21:00" itemprop="dateCreated datePublished" datetime="2016-09-14T13:21:00+08:00">2016-09-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/" itemprop="url" rel="index"><span itemprop="name">Hadoop</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>828</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>配置hadoop，主要是配置core-site.xml，hdfs-site.xml，mapred-site.xml，yarn-site.xml三个配置文件，默认下来，这些配置文件都是空的，所以很难知道这些配置文件有哪些配置可以生效，需要去Apache的官网中找对应版本的默认配置文件。YARN是新一代的MapReduce，又叫：MapReduce 2.0 (MRv2)。</p>
<h3 id="官网地址"><a href="#官网地址" class="headerlink" title="官网地址"></a>官网地址</h3><p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/">https://hadoop.apache.org/docs/</a><br>里面有各个版本的文档</p>
<h3 id="2-72版本默认配置"><a href="#2-72版本默认配置" class="headerlink" title="2.72版本默认配置"></a>2.72版本默认配置</h3><h4 id="core"><a href="#core" class="headerlink" title="core"></a>core</h4><p><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-common/core-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-common/core-default.xml</a></p>
<h4 id="hdfs"><a href="#hdfs" class="headerlink" title="hdfs"></a>hdfs</h4><p><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml</a></p>
<h4 id="mapreduce"><a href="#mapreduce" class="headerlink" title="mapreduce"></a>mapreduce</h4><p><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml</a></p>
<h4 id="yarn"><a href="#yarn" class="headerlink" title="yarn"></a>yarn</h4><p><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-common/yarn-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-common/yarn-default.xml</a></p>
<h3 id="常用的端口配置"><a href="#常用的端口配置" class="headerlink" title="常用的端口配置"></a>常用的端口配置</h3><p>网上复制的，没有经过验证</p>
<h4 id="HDFS端口"><a href="#HDFS端口" class="headerlink" title="HDFS端口"></a>HDFS端口</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认</th>
<th>配置文件</th>
<th>例子值</th>
</tr>
</thead>
<tbody><tr>
<td>fs.default.name</td>
<td>namenode RPC交互端口</td>
<td>8020</td>
<td>core-site.xml</td>
<td>hdfs:&#x2F;&#x2F;master:8020&#x2F;</td>
</tr>
<tr>
<td>dfs.http.address</td>
<td>NameNode web管理端口</td>
<td>50070</td>
<td>hdfs-site.xml</td>
<td>0.0.0.0:50070</td>
</tr>
<tr>
<td>dfs.datanode.address</td>
<td>datanode　控制端口</td>
<td>50010</td>
<td>hdfs-site.xml</td>
<td>0.0.0.0:50010</td>
</tr>
<tr>
<td>dfs.datanode.ipc.address</td>
<td>datanode的RPC服务器地址和端口</td>
<td>50020</td>
<td>hdfs-site.xml</td>
<td>0.0.0.0:50020</td>
</tr>
<tr>
<td>dfs.datanode.http.address</td>
<td>datanode的HTTP服务器和端口</td>
<td>50075</td>
<td>hdfs-site.xml</td>
<td>0.0.0.0:50075</td>
</tr>
</tbody></table>
<h4 id="MR端口"><a href="#MR端口" class="headerlink" title="MR端口"></a>MR端口</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认</th>
<th>配置文件</th>
<th>例子值</th>
</tr>
</thead>
<tbody><tr>
<td>mapred.job.tracker</td>
<td>job tracker交互端口</td>
<td>8021</td>
<td>mapred-site.xml</td>
<td>hdfs:&#x2F;&#x2F;master:8021&#x2F;</td>
</tr>
<tr>
<td>mapred.job.tracker.http.address</td>
<td>job tracker的web管理端口</td>
<td>50030</td>
<td>mapred-site.xml</td>
<td>0.0.0.0:50030</td>
</tr>
<tr>
<td>mapred.task.tracker.http.address</td>
<td>task tracker的HTTP端口</td>
<td>50060</td>
<td>mapred-site.xml</td>
<td>0.0.0.0:50060</td>
</tr>
</tbody></table>
<h4 id="其他端口"><a href="#其他端口" class="headerlink" title="其他端口"></a>其他端口</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认</th>
<th>配置文件</th>
<th>例子值</th>
</tr>
</thead>
<tbody><tr>
<td>dfs.secondary.http.address</td>
<td>secondary</td>
<td>NameNode web管理端口</td>
<td>50090</td>
<td>hdfs-site.xml</td>
</tr>
</tbody></table>
<h4 id="集群目录配置"><a href="#集群目录配置" class="headerlink" title="集群目录配置"></a>集群目录配置</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认</th>
<th>配置文件</th>
<th>例子值</th>
</tr>
</thead>
<tbody><tr>
<td>dfs.name.dir</td>
<td>name node的元数据,以,号隔开,hdfs会把元数据冗余复制到这些目录，一般这些目录是不同的块设备，不存在的目录会被忽略掉</td>
<td>{hadoop.tmp.dir}&#x2F;dfs&#x2F;name</td>
<td>hdfs-site.xm</td>
<td>&#x2F;hadoop&#x2F;hdfs&#x2F;name</td>
</tr>
<tr>
<td>dfs.name.edits.dir</td>
<td>node node的事务文件存储的目录,以,号隔开,hdfs会把事务文件冗余复制到这些目录，一般这些目录是不同的块设备，不存在的目录会被忽略掉</td>
<td>${dfs.name.dir}</td>
<td>hdfs-site.xm</td>
<td>${dfs.name.dir}</td>
</tr>
<tr>
<td>fs.checkpoint.dir</td>
<td>secondary NameNode的元数据以,号隔开,hdfs会把元数据冗余复制到这些目录，一般这些目录是不同的块设备，不存在的目录会被忽略掉</td>
<td>${hadoop.tmp.dir}&#x2F;dfs&#x2F;namesecondary</td>
<td>core-site.xml</td>
<td>&#x2F;hadoop&#x2F;hdfs&#x2F;namesecondary</td>
</tr>
<tr>
<td>fs.checkpoint.edits.dir</td>
<td>secondary NameNode的事务文件存储的目录,以,号隔开,hdfs会把事务文件冗余复制到这些目录</td>
<td>${fs.checkpoint.dir}</td>
<td>core-site.xml</td>
<td>${fs.checkpoint.dir}</td>
</tr>
<tr>
<td>hadoop.tmp.dir</td>
<td>临时目录,其他临时目录的父目录</td>
<td>&#x2F;tmp&#x2F;hadoop-${user.name}</td>
<td>core-site.xml</td>
<td>&#x2F;hadoop&#x2F;tmp&#x2F;hadoop-${user.name}</td>
</tr>
<tr>
<td>dfs.data.dir</td>
<td>data node的数据目录,以,号隔开,hdfs会把数据存在这些目录下，一般这些目录是不同的块设备，不存在的目录会被忽略掉</td>
<td>${hadoop.tmp.dir}&#x2F;dfs&#x2F;data</td>
<td>hdfs-site.xm</td>
<td>&#x2F;hadoop&#x2F;hdfs&#x2F;data1&#x2F;data,<br>&#x2F;hadoop&#x2F;hdfs&#x2F;data2&#x2F;data</td>
</tr>
<tr>
<td>mapred.local.dir</td>
<td>MapReduce产生的中间数据存放目录,以,号隔开,hdfs会把数据存在这些目录下，一般这些目录是不同的块设备，不存在的目录会被忽略掉</td>
<td>${hadoop.tmp.dir}&#x2F;mapred&#x2F;local</td>
<td>mapred-site.xml</td>
<td>&#x2F;hadoop&#x2F;hdfs&#x2F;data1&#x2F;mapred&#x2F;local,<br>&#x2F;hadoop&#x2F;hdfs&#x2F;data2&#x2F;mapred&#x2F;local</td>
</tr>
<tr>
<td>mapred.system.dir</td>
<td>MapReduce的控制文件</td>
<td>${hadoop.tmp.dir}&#x2F;mapred&#x2F;system</td>
<td>mapred-site.xml</td>
<td>&#x2F;hadoop&#x2F;hdfs&#x2F;data1&#x2F;system</td>
</tr>
</tbody></table>
<h4 id="其他配置"><a href="#其他配置" class="headerlink" title="其他配置"></a>其他配置</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认</th>
<th>配置文件</th>
<th>例子值</th>
</tr>
</thead>
<tbody><tr>
<td>dfs.support.append</td>
<td>支持文件append，主要是支持hbase</td>
<td>false</td>
<td>hdfs-site.xml</td>
<td>true</td>
</tr>
<tr>
<td>dfs.replication</td>
<td>文件复制的副本数，如果创建时不指定这个参数，就使用这个默认值作为复制的副本数</td>
<td>3</td>
<td>hdfs-site.xml</td>
<td>2</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/Hadoop%202.7.2%20%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/Hadoop%202.7.2%20%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">Hadoop 2.7.2 安装配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-09-13 22:11:00" itemprop="dateCreated datePublished" datetime="2016-09-13T22:11:00+08:00">2016-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hadoop/" itemprop="url" rel="index"><span itemprop="name">Hadoop</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>5 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>官网地址：<br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/">http://hadoop.apache.org/</a></p>
<p>各个版本文档地址：<br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/">http://hadoop.apache.org/docs/</a></p>
<h2 id="1、环境"><a href="#1、环境" class="headerlink" title="1、环境"></a>1、环境</h2><p><strong>版本信息</strong><br>CentOS Linux release 7.2.1511 (Core)<br>Hadoop 2.7.2<br>java version “1.7.0_80”  </p>
<p><strong>&#x2F;etc&#x2F;hosts</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.213    wwh213</span><br><span class="line">192.168.1.214    wwh214</span><br><span class="line">192.168.1.215    wwh215</span><br></pre></td></tr></table></figure>
<p>确保各个主机都能正确解析主机名和IP</p>
<blockquote>
<p><em><strong>注意：</strong></em>&#x2F;etc&#x2F;hosts 中配置节点与IP时需要注意，不要配置如：“127.0.0.1 master” 这样的，会导致无法绑定正确的IP  </p>
</blockquote>
<p><strong>集群结构</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Master    192.168.1.213    wwh213  </span><br><span class="line">Slave1    192.168.1.214    wwh214  </span><br><span class="line">Slave2    192.168.1.215    wwh215</span><br></pre></td></tr></table></figure>

<h2 id="2、创建hadoop用户"><a href="#2、创建hadoop用户" class="headerlink" title="2、创建hadoop用户"></a>2、创建hadoop用户</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#创建hadoop用户</span><br><span class="line">adduser hadoop</span><br><span class="line"></span><br><span class="line">#修改密码</span><br><span class="line">passwd hadoop</span><br></pre></td></tr></table></figure>
<p>以下操作都在hadoop用户下进行，注意目录权限。</p>
<h2 id="3、SSH免密码登录"><a href="#3、SSH免密码登录" class="headerlink" title="3、SSH免密码登录"></a>3、SSH免密码登录</h2><blockquote>
<p>无密码登陆是指通过证书认证的方式进行登陆，使用<strong>公私钥</strong>认证的方式来进行ssh登录。<br><strong>公私钥</strong>认证方式简单的解释：首先在客户端上创建一对公私钥<br>公钥文件：<del>&#x2F;.ssh&#x2F;id_rsa.pub<br>私钥文件：</del>&#x2F;.ssh&#x2F;id_rsa<br>然后把公钥添加到服务器上的（~&#x2F;.ssh&#x2F;authorized_keys）文件里面，自己保留好私钥。<br>登录时客户端会向服务器请求使用密匙进行安全验证并发送公钥到服务端，服务端会对比公钥如果匹配成功服务端会生成一个随机数然后用该公钥加密再发给客户端，客户端通过私钥解密后发给服务端进行确认。</p>
</blockquote>
<p>受信任的远程主机公钥会保存到 ~&#x2F;.ssh&#x2F;known_hosts文件中</p>
<p>Hadoop需要通过SSH登录到各个节点进行操作，每台服务器都生成公钥，再合并到authorized_keys  </p>
<p>***&#x3D;&#x3D;注意&#x3D;&#x3D;<em>：authorized_keys的权限要是600</em>*</p>
<ol>
<li>CentOS默认没有启动ssh无密登录，去掉&#x2F;etc&#x2F;ssh&#x2F;sshd_config其中两行的注释，每台服务器都要设置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br></pre></td></tr></table></figure></li>
<li>输入命令，<strong>ssh-keygen -t rsa</strong>，生成key，都不输入密码，一直回车，就会在~&#x2F;.ssh文件夹生成<blockquote>
<p><strong>id_rsa</strong>    私钥<br><strong>id_rsa.pub</strong>    公钥</p>
</blockquote>
</li>
</ol>
<p>在每台服务器都生成一次</p>
<ol start="3">
<li><p>合并全部的公钥到一个authorized_keys文件，在Master服务器，进入~&#x2F;.ssh目录，通过SSH命令合并</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#cat id_rsa.pub&gt;&gt; authorized_keys</span><br><span class="line">#使公钥添加到known_hosts中</span><br><span class="line">ssh hadoop@wwh213 cat ~/.ssh/id_rsa.pub&gt;&gt; authorized_keys</span><br><span class="line"></span><br><span class="line">ssh hadoop@wwh214 cat ~/.ssh/id_rsa.pub&gt;&gt; authorized_keys</span><br><span class="line"></span><br><span class="line">ssh hadoop@wwh215 cat ~/.ssh/id_rsa.pub&gt;&gt; authorized_keys</span><br></pre></td></tr></table></figure>
</li>
<li><p>把Master服务器的<strong>authorized_keys</strong>、<strong>known_hosts</strong>复制到Slave服务器的~&#x2F;.ssh目录  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp authorized_keys known_hosts hadoop@wwh214:~/.ssh/</span><br><span class="line"></span><br><span class="line">scp authorized_keys known_hosts hadoop@wwh215:~/.ssh/</span><br></pre></td></tr></table></figure>
</li>
<li><p>完成之后 ssh wwh214、ssh wwh215就不需要输入密码了</p>
</li>
</ol>
<h2 id="4、安装JDK"><a href="#4、安装JDK" class="headerlink" title="4、安装JDK"></a>4、安装JDK</h2><p>Hadoop 2.7已经不再支持JDK6了，需要JDK7+</p>
<p><em><strong>之前已经安装过JDK了，下面是一个例子</strong></em></p>
<ol>
<li>下载“jdk-7u80-linux-x64.gz”，放到&#x2F;data&#x2F;java目录下  </li>
<li>解压缩<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-7u79-linux-x64.gz  </span><br></pre></td></tr></table></figure></li>
<li>编辑&#x2F;etc&#x2F;profile，加上：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/data/java/jdk1.7.0_80</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin </span><br></pre></td></tr></table></figure></li>
<li>使配置生效，输入命令：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li>
<li>进行测试<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></li>
</ol>
<p><em><strong>或者直接下载 jdk-7u<version>-linux-x64.rpm 以root用户进行安装，将安装到&#x2F;usr&#x2F;java 目录中</strong></em></p>
<h2 id="5、安装Hadoop-2-7-2"><a href="#5、安装Hadoop-2-7-2" class="headerlink" title="5、安装Hadoop 2.7.2"></a>5、安装Hadoop 2.7.2</h2><p>只需要在Master服务器解压配置好，再复制到Slave服务器  </p>
<p>配置hadoop，主要是配置<strong>core-site.xml</strong>，<strong>hdfs-site.xml</strong>，<strong>mapred-site.xml</strong>，<strong>yarn-site.xml</strong> 几个配置文件，默认这些配置文件都是空的，由于版本差异很难知道这些配置文件有哪些配置可以生效，需要去Apache的官网中找对应版本的默认配置文件。  </p>
<p><strong>官网文档地址：</strong>  </p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/">http://hadoop.apache.org/docs/r2.7.2/</a></p>
</blockquote>
<hr>
<ol>
<li><p>下载 hadoop-2.7.2.tar.gz ，放到&#x2F;data&#x2F;hadoop目录下  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://archive.apache.org/dist/hadoop/common/hadoop-2.7.2/hadoop-2.7.2.tar.gz</span><br><span class="line"></span><br><span class="line">wget http://apache.fayea.com/hadoop/common/hadoop-2.7.2/hadoop-2.7.2.tar.gz</span><br></pre></td></tr></table></figure></li>
<li><p>解压  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf hadoop-2.7.2.tar.gz</span><br></pre></td></tr></table></figure></li>
<li><p>在&#x2F;data&#x2F;hadoop目录下创建数据存放的文件夹  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir tmp</span><br><span class="line">mkdir hdfs</span><br><span class="line">mkdir hdfs/data</span><br><span class="line">mkdir hdfs/name</span><br></pre></td></tr></table></figure></li>
<li><p>配置JAVA_HOME<br>修改&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2&#x2F;etc&#x2F;hadoop目录下hadoop-env.sh、yarn-env.sh的JAVA_HOME  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/data/java/jdk1.7.0_80</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果环境变量配置好了也可以不用配置，默认是：export JAVA_HOME&#x3D;${JAVA_HOME}<br>看启动时的提示</p>
</blockquote>
</li>
<li><p>配置&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2&#x2F;etc&#x2F;hadoop目录下的core-site.xml<br><strong>官方默认的配置文件</strong><br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-common/core-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-common/core-default.xml</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;hdfs://192.168.1.213:9000&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;file:/data/hadoop/tmp&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;io.file.buffer.size&lt;/name&gt;</span><br><span class="line">        &lt;!-- 缺省值是4096 --&gt;</span><br><span class="line">        &lt;value&gt;131072&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>配置&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2&#x2F;etc&#x2F;hadoop目录下的hdfs-site.xml<br><strong>官方默认的配置文件</strong><br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;file:/data/hadoop/hdfs/name&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;file:/data/hadoop/hdfs/data&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">        &lt;!-- 缺省值是3 --&gt;</span><br><span class="line">        &lt;value&gt;2&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 关闭权限检查 --&gt;    </span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.permissions.enabled&lt;/name&gt;</span><br><span class="line">        &lt;!-- 缺省值是true --&gt;</span><br><span class="line">        &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2&#x2F;etc&#x2F;hadoop目录下的mapred-site.xml<br><strong>官方默认的配置文件</strong><br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;</span><br><span class="line">        &lt;!-- 缺省值是：0.0.0.0:10020 --&gt;</span><br><span class="line">        &lt;value&gt;192.168.1.213:10020&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;</span><br><span class="line">        &lt;!-- 缺省值是：0.0.0.0:19888 --&gt;</span><br><span class="line">        &lt;value&gt;192.168.1.213:19888&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2&#x2F;etc&#x2F;hadoop目录下的yarn-site.xml<br><strong>官方默认的配置文件</strong><br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-common/yarn-default.xml">http://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-common/yarn-default.xml</a>  </p>
<blockquote>
<p>YARN：新一代的MapReduce。  MapReduce 2.0 (MRv2)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</span><br><span class="line">        &lt;!-- 缺省值是：0.0.0.0 --&gt;</span><br><span class="line">        &lt;value&gt;192.168.1.213&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2&#x2F;etc&#x2F;hadoop目录下的slaves，删除默认的localhost，增加2个从节点<br><em>如果配置主节点的IP的话就是既当 NameNode 又当 DataNode</em>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.213</span><br><span class="line">192.168.1.214</span><br><span class="line">192.168.1.215</span><br></pre></td></tr></table></figure>
</li>
<li><p>将配置好的Hadoop复制到各个节点对应位置上，通过scp传送</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /data/hadoop wwh214:/data/</span><br><span class="line">scp -r /data/hadoop wwh215:/data/</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="6、启动-Hadoop"><a href="#6、启动-Hadoop" class="headerlink" title="6、启动 Hadoop"></a>6、启动 Hadoop</h2><p>在Master服务器启动hadoop，从节点会自动启动，进入&#x2F;data&#x2F;hadoop&#x2F;hadoop-2.7.2目录  </p>
<p>(1)初始化，输入命令  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>

<p>(2)全部启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbin/start-all.sh</span><br></pre></td></tr></table></figure>

<p>也可以分开启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sbin/start-dfs.sh</span><br><span class="line">sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>

<p>(3)停止的话，输入命令  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbin/stop-all.sh</span><br></pre></td></tr></table></figure>

<p>也可以分开停止</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sbin/stop-dfs.sh</span><br><span class="line">sbin/stop-yarn.sh</span><br></pre></td></tr></table></figure>


<p>(4)输入命令，jps，可以看到相关信息</p>
<h4 id="Web访问"><a href="#Web访问" class="headerlink" title="Web访问"></a>Web访问</h4><p>要先开放端口或者直接关闭防火墙  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service  </span><br></pre></td></tr></table></figure>

<h5 id="All-Applications"><a href="#All-Applications" class="headerlink" title="All Applications"></a>All Applications</h5><p><a target="_blank" rel="noopener" href="http://192.168.1.213:8088/">http://192.168.1.213:8088/</a>  </p>
<h5 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a>HDFS</h5><p><a target="_blank" rel="noopener" href="http://192.168.1.213:50070/">http://192.168.1.213:50070/</a>  </p>
<h5 id="Map-Reduce"><a href="#Map-Reduce" class="headerlink" title="Map&#x2F;Reduce"></a>Map&#x2F;Reduce</h5><p><a target="_blank" rel="noopener" href="http://192.168.1.213:50030/">http://192.168.1.213:50030/</a>  </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/Maven/Maven/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Maven/Maven/" class="post-title-link" itemprop="url">Maven</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-08-21 23:41:00" itemprop="dateCreated datePublished" datetime="2016-08-21T23:41:00+08:00">2016-08-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Maven/" itemprop="url" rel="index"><span itemprop="name">Maven</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>871</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Maven项目对象模型(POM)，可以通过一小段描述信息来管理项目的构建，报告和文档的软件项目管理工具。<br>Maven是一个用于项目构建的工具，通过它便捷的管理项目的生命周期。即项目的jar包依赖，开发，测试，发布打包。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><em>以下是以Linux为例，Windows下配置也基本相同。</em></p>
<h4 id="1-下载"><a href="#1-下载" class="headerlink" title="1. 下载"></a>1. 下载</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.cnnic.cn/apache/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.tar.gz</span><br></pre></td></tr></table></figure>

<h4 id="2-解压"><a href="#2-解压" class="headerlink" title="2. 解压"></a>2. 解压</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-maven-3.3.9-bin.tar.gz </span><br></pre></td></tr></table></figure>

<p>如需使用软连接  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s apache-maven-3.3.9 maven</span><br></pre></td></tr></table></figure>

<h4 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3. 修改配置文件"></a>3. 修改配置文件</h4><p>本地仓库默认是<strong>用户目录</strong>下的<code>.m2\repository</code>，用户级的配置文件<code>settings.xml</code>也放在这里。</p>
<p>全局配置修改：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi conf/settings.xml</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#设置本地资源库位置</span><br><span class="line">&lt;localRepository&gt;/home/maven/.m2/repository&lt;/localRepository&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4-配置环境变量"><a href="#4-配置环境变量" class="headerlink" title="4. 配置环境变量"></a>4. 配置环境变量</h4><p>添加环境变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export M2_HOME=/home/maven/maven</span><br><span class="line">export PATH=$PATH:$M2_HOME/bin</span><br></pre></td></tr></table></figure>

<p>使环境变量生效  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h4 id="5-验证是否安装成功"><a href="#5-验证是否安装成功" class="headerlink" title="5. 验证是否安装成功"></a>5. 验证是否安装成功</h4><h2 id="在其他目录执行"><a href="#在其他目录执行" class="headerlink" title="在其他目录执行"></a>在其他目录执行<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -version</span><br></pre></td></tr></table></figure></h2><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><ol>
<li><code>mvn archetype:create</code>   ：创建 Maven 项目</li>
<li><code>mvn compile</code>   ：编译源代码</li>
<li><code>mvn test-compile</code>   ：编译测试代码</li>
<li><code>mvn test</code>   ： 运行应用程序中的单元测试</li>
<li><code>mvn site</code>   ： 生成项目相关信息的网站</li>
<li><code>mvn clean</code>   ：清除目标目录中的生成结果</li>
<li><code>mvn package</code>   ： 依据项目生成 jar 文件</li>
<li><code>mvn install</code>   ：在本地 Repository 中安装 jar</li>
<li><code>mvn eclipse:eclipse</code>   ：生成 Eclipse 项目文件</li>
<li><code>mvn idea:idea </code>   : 生成idea项目</li>
<li><code>mvn jar:jar</code>   : 只打jar包</li>
<li><code>mvn eclipse:clean</code>   : 清除eclipse的一些系统设置</li>
<li><code>mvn jetty:run</code>   : 运行项目于jetty上</li>
<li><code>mvn -DskipTests=true</code>   : 忽略测试文档编译</li>
</ol>
<hr>
<h2 id="关于仓库"><a href="#关于仓库" class="headerlink" title="关于仓库"></a>关于仓库</h2><h4 id="本地仓库"><a href="#本地仓库" class="headerlink" title="本地仓库"></a>本地仓库</h4><p>本地仓库默认是用户目录下的.m2\repository，用户可以通过settings.xml设置  </p>
<h4 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h4><p>maven的远程仓库有多种存在形式，中央仓库，其他远程仓库，镜像，私服</p>
<h5 id="1-中央仓库"><a href="#1-中央仓库" class="headerlink" title="1. 中央仓库"></a>1. 中央仓库</h5><p>中央仓库是默认的远程仓库，如果不做任何特殊配置那么将会从中央仓库下载依赖，这在<br><code>$M2_HOME/lib/maven-model-builder-3.0.4.jar</code>里的<code>org/apache/maven/model/pom-4.0.0.xml</code>里做了指定，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;repositories&gt;</span><br><span class="line">    &lt;repository&gt;</span><br><span class="line">        &lt;id&gt;central&lt;/id&gt;</span><br><span class="line">        &lt;name&gt;Central Repository&lt;/name&gt;</span><br><span class="line">        &lt;url&gt;http://repo.maven.apache.org/maven2&lt;/url&gt;</span><br><span class="line">        &lt;layout&gt;default&lt;/layout&gt;</span><br><span class="line">        &lt;snapshots&gt;</span><br><span class="line">            &lt;enabled&gt;false&lt;/enabled&gt;</span><br><span class="line">        &lt;/snapshots&gt;</span><br><span class="line">    &lt;/repository&gt;</span><br><span class="line">&lt;/repositories&gt;</span><br></pre></td></tr></table></figure>

<h5 id="2-镜像"><a href="#2-镜像" class="headerlink" title="2. 镜像"></a>2. 镜像</h5><p>镜像是将的maven依赖请求转发至相应服务器，配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;mirror&gt;</span><br><span class="line">    &lt;id&gt;mirrorId&lt;/id&gt;</span><br><span class="line">    &lt;mirrorOf&gt;repositoryId&lt;/mirrorOf&gt;</span><br><span class="line">    &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;</span><br><span class="line">    &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt;</span><br><span class="line">&lt;/mirror&gt;</span><br></pre></td></tr></table></figure>

<p>这里即是将仓库id为<code>repositoryId</code>的所有请求转发至<code>http://my.repository.com/repo/path</code>镜像服务器<br>镜像更为常用的作法是结合私服，如下配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;mirror&gt;</span><br><span class="line">    &lt;id&gt;mirrorId&lt;/id&gt;</span><br><span class="line">    &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</span><br><span class="line">    &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;</span><br><span class="line">    &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt;</span><br><span class="line">&lt;/mirror&gt;</span><br></pre></td></tr></table></figure>
<p>这里即是将对所有仓库的请求转发至私服<code>http://my.repository.com/repo/path</code></p>
<h5 id="3-私服"><a href="#3-私服" class="headerlink" title="3. 私服"></a>3. 私服</h5><p>私服一般采用nexus部署</p>
<hr>
<h3 id="添加其他远程仓库"><a href="#添加其他远程仓库" class="headerlink" title="添加其他远程仓库"></a>添加其他远程仓库</h3><p>添加一个其他的远程库只需在项目的pom.xml文件中添加以下配置即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;repositories&gt;</span><br><span class="line">    &lt;repository&gt;</span><br><span class="line">        &lt;id&gt;jboss&lt;/id&gt;</span><br><span class="line">        &lt;name&gt;JBoss Repository&lt;/name&gt;</span><br><span class="line">        &lt;url&gt;http://repository.jboss.org/nexus/content/groups/public/&lt;/url&gt;</span><br><span class="line">        &lt;snapshots&gt;</span><br><span class="line">        &lt;enabled&gt;false&lt;/enabled&gt;</span><br><span class="line">        &lt;/snapshots&gt;</span><br><span class="line">        &lt;releases&gt;</span><br><span class="line">            &lt;enabled&gt;true&lt;/enabled&gt;</span><br><span class="line">        &lt;/releases&gt;</span><br><span class="line">        &lt;layout&gt;default&lt;/layout&gt;</span><br><span class="line">    &lt;/repository&gt;</span><br><span class="line">&lt;/repositories&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>snapshots false表示关闭jboss远程仓库的snapshots版本下载 </li>
<li>releases true表示打开jboss远程仓库的release版本下载</li>
</ul>
<h3 id="远程服务器的验证"><a href="#远程服务器的验证" class="headerlink" title="远程服务器的验证"></a>远程服务器的验证</h3><p>远程服务器的验证，只需在settings.xml添加如下代码即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;server&gt;</span><br><span class="line">    &lt;id&gt;deploymentRepo&lt;/id&gt;</span><br><span class="line">    &lt;username&gt;repouser&lt;/username&gt;</span><br><span class="line">    &lt;password&gt;repopwd&lt;/password&gt;</span><br><span class="line">&lt;/server&gt;</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：id要与配置的远程服务器id对应比如 jboss</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/SVN/SVN%E8%BF%81%E7%A7%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/SVN/SVN%E8%BF%81%E7%A7%BB/" class="post-title-link" itemprop="url">SVN迁移</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-08-13 11:13:00" itemprop="dateCreated datePublished" datetime="2016-08-13T11:13:00+08:00">2016-08-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" itemprop="url" rel="index"><span itemprop="name">版本控制</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/SVN/" itemprop="url" rel="index"><span itemprop="name">SVN</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>857</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>从window平台迁移到linux平台</p>
<h3 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h3><pre><code>windows 平台导出到 linux 的时候不能使用powershell，需要用CMD导出dump文件  
否则会出现：`svnadmin: E140001: XXX`错误
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#svnadmin dump 原先的repos的目录路径（/repository/directory） &gt; dumpfile</span><br><span class="line"></span><br><span class="line">svnadmin dump /opt/svn/xxx/ &gt; /var/tmp/dump-xxx.svn</span><br></pre></td></tr></table></figure>


<h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><pre><code>在目标机器上创建同名的资源库
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">svnadmin create xx1</span><br><span class="line"></span><br><span class="line">svnadmin create software</span><br><span class="line"></span><br><span class="line">svnadmin create xx2</span><br></pre></td></tr></table></figure>


<h3 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">svnadmin load xx1 &lt; /data/svn-backup/repository-xx1-0826.svn</span><br><span class="line"></span><br><span class="line">svnadmin load software &lt; /data/svn-backup/repository-software-0826.svn</span><br><span class="line"></span><br><span class="line">svnadmin load xx2 &lt; /data/svn-backup/repository-xx2-0826.svn</span><br></pre></td></tr></table></figure>


<h3 id="SVN重定向"><a href="#SVN重定向" class="headerlink" title="SVN重定向"></a>SVN重定向</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">svn help relocate</span><br><span class="line">relocate: 重新定位工作副本，指向不同的版本库根 URL。</span><br><span class="line">用法:  1. relocate FROM-PREFIX TO-PREFIX [PATH...]</span><br><span class="line">       2. relocate TO-URL [PATH]</span><br><span class="line"></span><br><span class="line">  改写工作副本 URL 元数据，以反映仅版本库根 URL 的改变。这用于仅版本库根</span><br><span class="line">  URL 改变(例如方案或主机名称)，但是工作副本内容仍旧与版本库对应的情况。</span><br><span class="line"></span><br><span class="line">  1. FROM-PREFIX 和 TO-PREFIX 分别对应工作副本的旧 URL 与新 URL 开始子串</span><br><span class="line">     (如果你喜欢，可以指定完整的 URL)。请使用 &#x27;svn info&#x27; 来确定当前工作</span><br><span class="line">     副本的 URL。</span><br><span class="line"></span><br><span class="line">  2. TO-URL 是用于 PATH 的(完整的)新版本库 URL。</span><br><span class="line"></span><br><span class="line">  例如:</span><br><span class="line">    svn relocate http:// svn:// project1 project2</span><br><span class="line">    svn relocate http://www.example.com/repo/project \</span><br><span class="line">                 svn://svn.example.com/repo/project</span><br><span class="line"></span><br><span class="line">有效选项: </span><br><span class="line">  --ignore-externals       : 忽略外部项目</span><br><span class="line"></span><br><span class="line">全局选项: </span><br><span class="line">  --username ARG           : 指定用户名称 ARG</span><br><span class="line">  --password ARG           : 指定密码 ARG</span><br><span class="line">  --no-auth-cache          : 不要缓存用户认证令牌</span><br><span class="line">  --non-interactive        : 不要交互提示</span><br><span class="line">  --trust-server-cert      : 不提示的接受未知的证书颁发机构发行的 SSL 服务器证书(只用于选项 “--non-interactive”)</span><br><span class="line">  --config-dir ARG         : 从目录 ARG 读取用户配置文件</span><br><span class="line">  --config-option ARG      : 以下属格式设置用户配置选项：</span><br><span class="line">                                 FILE:SECTION:OPTION=[VALUE]</span><br><span class="line">                             例如：</span><br><span class="line">                                 servers:global:http-library=serf</span><br></pre></td></tr></table></figure>


<p>查看信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svn info</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">路径: .</span><br><span class="line">工作副本根目录: /home/svn/xx1-parent</span><br><span class="line">URL: https://192.168.1.99/svn/xx1/trunk/xx1-parent</span><br><span class="line">版本库根: https://192.168.1.99/svn/xx1</span><br><span class="line">版本库 UUID: 6b1cbf4a-421d-7440-86c9-1259917cfc4a</span><br><span class="line">版本: 966</span><br><span class="line">节点种类: 目录</span><br><span class="line">调度: 正常</span><br><span class="line">最后修改的作者: wwh</span><br><span class="line">最后修改的版本: 966</span><br><span class="line">最后修改的时间: 2016-08-25 18:10:15 +0800 (四, 2016-08-25)</span><br></pre></td></tr></table></figure>

<p>命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#svn relocate 【之前svn路径】【新的svn路径】</span><br><span class="line">xx1-parent]# svn relocate https://192.168.1.99/svn/xx1/trunk/xx1-parent svn://192.168.1.210/xx1/trunk/xx1-parent</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">svn relocate https://192.168.1.99/svn/xx1/trunk/xx1-parent svn://192.168.1.210/xx1/trunk/xx1-parent</span><br><span class="line"></span><br><span class="line">认证领域: &lt;svn://192.168.1.210:3690&gt; 6b1cbf4a-421d-7440-86c9-1259917cfc4a</span><br><span class="line">“root”的密码: </span><br><span class="line">认证领域: &lt;svn://192.168.1.210:3690&gt; 6b1cbf4a-421d-7440-86c9-1259917cfc4a</span><br><span class="line">用户名: wang.wenhua</span><br><span class="line">“wang.wenhua”的密码: </span><br><span class="line"></span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">注意!  你的密码，对于认证域:</span><br><span class="line"></span><br><span class="line">   &lt;svn://192.168.1.210:3690&gt; 6b1cbf4a-421d-7440-86c9-1259917cfc4a</span><br><span class="line"></span><br><span class="line">只能明文保存在磁盘上!  如果可能的话，请考虑配置你的系统，让 Subversion</span><br><span class="line">可以保存加密后的密码。请参阅文档以获得详细信息。</span><br><span class="line"></span><br><span class="line">你可以通过在“/root/.subversion/servers”中设置选项“store-plaintext-passwords”为“yes”或“no”，</span><br><span class="line">来避免再次出现此警告。</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">保存未加密的密码(yes/no)?yes</span><br></pre></td></tr></table></figure>

<p>eclipse中    </p>
<blockquote>
<p>切换到SVN 视图，右键资源库，选择重定位 –&gt; 输入新的URL  </p>
</blockquote>
<blockquote>
<p>如果不能重定位，可在资源管理器的目录上使用SVN客户端重定位<br>在项目上右键 –&gt; team –&gt; 断开连接 （不删除SVN元信息）<br>在SVN视图中创建新的资源库，指向新的地址<br>然后再在项目上右键 –&gt; team –&gt; share project（eclipse会识别目录中SVN信息）</p>
</blockquote>
<p>TortoiseSVN客户端:  </p>
<blockquote>
<p>在工作复本的根目录上右键 –&gt; TortoiseSVN –&gt; 重新定位(Relocate)，然后修改URL</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/SVN/SVN%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/SVN/SVN%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">SVN安装配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-06-13 14:28:00" itemprop="dateCreated datePublished" datetime="2016-06-13T14:28:00+08:00">2016-06-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" itemprop="url" rel="index"><span itemprop="name">版本控制</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/SVN/" itemprop="url" rel="index"><span itemprop="name">SVN</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>450</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="查看："><a href="#查看：" class="headerlink" title="查看："></a>查看：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa subversion</span><br></pre></td></tr></table></figure>

<h3 id="列出："><a href="#列出：" class="headerlink" title="列出："></a>列出：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list | grep subversion</span><br></pre></td></tr></table></figure>

<h3 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install subversion</span><br></pre></td></tr></table></figure>

<h3 id="查看安装版本"><a href="#查看安装版本" class="headerlink" title="查看安装版本"></a>查看安装版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svnserve --version</span><br></pre></td></tr></table></figure>

<h3 id="创建SVN版本库目录"><a href="#创建SVN版本库目录" class="headerlink" title="创建SVN版本库目录"></a>创建SVN版本库目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/svn/svnrepos</span><br></pre></td></tr></table></figure>

<h3 id="创建版本库"><a href="#创建版本库" class="headerlink" title="创建版本库"></a>创建版本库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svnadmin create /var/svn/svnrepos</span><br></pre></td></tr></table></figure>

<p>执行了这个命令之后会在&#x2F;var&#x2F;svn&#x2F;svnrepos目录下生成一些文件</p>
<p>进入conf目录（该svn版本库配置文件）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd conf</span><br></pre></td></tr></table></figure>
<pre><code>authz  文件是权限控制文件  
passwd  是帐号密码文件  
svnserve.conf SVN服务配置文件  
</code></pre>
<p><strong>以上文件， 左侧不能留空格, 否则会出错！</strong></p>
<h3 id="设置帐号密码"><a href="#设置帐号密码" class="headerlink" title="设置帐号密码"></a>设置帐号密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi passwd</span><br></pre></td></tr></table></figure>
<p>在[users]块中添加用户和密码，格式：帐号&#x3D;密码，如：hello&#x3D;123</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[users]</span><br><span class="line"># harry = harryssecret</span><br><span class="line"># sally = sallyssecret</span><br><span class="line">hello=123</span><br><span class="line">用户名=密码</span><br></pre></td></tr></table></figure>

<h3 id="设置权限"><a href="#设置权限" class="headerlink" title="设置权限"></a>设置权限</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi authz</span><br></pre></td></tr></table></figure>
<p>指定单个用户：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[/]  </span><br><span class="line">hello=rw  </span><br></pre></td></tr></table></figure>
<p><em>意思是hello用户对所有的目录有读写权限</em>  </p>
<p>指定用户组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[groups]</span><br><span class="line">admin=admin,admin2,admin3</span><br><span class="line">user=user1,user2,user3</span><br><span class="line">[/]</span><br><span class="line">@admin=rw   #admin组内的用户有obj的读写权限</span><br><span class="line">@user=rw    #user组内的用户有obj的读写权限</span><br></pre></td></tr></table></figure>


<h3 id="修改svnserve-conf文件"><a href="#修改svnserve-conf文件" class="headerlink" title="修改svnserve.conf文件"></a>修改svnserve.conf文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi svnserve.conf</span><br></pre></td></tr></table></figure>
<p>打开下面的几个注释：</p>
<pre><code>anon-access = none  #匿名用无法访问  
auth-access = write  #授权用户可写  
password-db = passwd  #使用哪个文件作为账号文件  
authz-db = authz  #使用哪个文件作为权限文件  
realm = /var/svn/svnrepos  #认证空间名，版本库所在目录  
</code></pre>
<h3 id="启动svn版本库"><a href="#启动svn版本库" class="headerlink" title="启动svn版本库"></a>启动svn版本库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">svnserve -d -r /var/svn/svnrepos</span><br><span class="line"></span><br><span class="line">#改变端口</span><br><span class="line">svnserve -d -r /opt/svn/repos --listen-port 3391</span><br></pre></td></tr></table></figure>

<p><strong>-d [–daemon]</strong>  后台运行<br><strong>-r [–root]</strong>  服务的根目录。可以具体指定到一个Repository的所在目录，仅提供一个Repository的访问；而如果要同时访问多个Repository，则-r选项需要指向多个Repository所在的父目录。</p>
<p>地址为: svn:&#x2F;&#x2F;your server address （如果指定端口需要添加端口  :端口号）</p>
<h4 id="停止SVN"><a href="#停止SVN" class="headerlink" title="停止SVN"></a>停止SVN</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep svnserve</span><br><span class="line"></span><br><span class="line">kill -9 ID号</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">killall svnserve</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://wangwen135.github.io/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/Arduino/TCS3002D-Color-Sensor-%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="王某某">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王某某的笔记">
      <meta itemprop="description" content="这是一个使用 Hexo 构建的博客，用于分享我的编程经验和学习笔记。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 王某某的笔记">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/Arduino/TCS3002D-Color-Sensor-%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">TCS3002D-Color-Sensor-测试</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2015-12-09 00:00:00" itemprop="dateCreated datePublished" datetime="2015-12-09T00:00:00+08:00">2015-12-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/" itemprop="url" rel="index"><span itemprop="name">硬件与物联网</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A1%AC%E4%BB%B6%E4%B8%8E%E7%89%A9%E8%81%94%E7%BD%91/Arduino/" itemprop="url" rel="index"><span itemprop="name">Arduino</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>757</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Arduino Color Sensor TCS3002D </p>
<p>颜色传感器 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line">#define led 7 //led</span><br><span class="line">#define S0    6   //物体表面的反射光越强，TCS3002D内置振荡器产生的方波频率越高，</span><br><span class="line">#define S1    5  //S0和S1的组合决定输出信号频率比例因子，比例因子为2%</span><br><span class="line">//比率因子为TCS3200传感器OUT引脚输出信号频率与其内置振荡器频率之比</span><br><span class="line">#define S2     4   //S2和S3的组合决定让红、绿、蓝，哪种光线通过滤波器</span><br><span class="line">#define S3     3</span><br><span class="line">#define OUT    2</span><br><span class="line"></span><br><span class="line">int   g_count = 0;    // count the frequecy</span><br><span class="line">int   g_array[3];     // store the RGB value</span><br><span class="line">float g_SF[3];        // save the RGB Scale factor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//初始化</span><br><span class="line">void TSC_Init()</span><br><span class="line">&#123;</span><br><span class="line">  pinMode(led, OUTPUT);</span><br><span class="line">  pinMode(S0, OUTPUT);</span><br><span class="line">  pinMode(S1, OUTPUT);</span><br><span class="line">  pinMode(S2, OUTPUT);</span><br><span class="line">  pinMode(S3, OUTPUT);</span><br><span class="line">  pinMode(OUT, INPUT);</span><br><span class="line"></span><br><span class="line">  //比例</span><br><span class="line">  //S0 L S1 H 2%</span><br><span class="line">  //S0 H S1 L 20%</span><br><span class="line">  //S0 H S1 H 100%</span><br><span class="line">  changScaling(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//选择颜色过滤</span><br><span class="line">//滤波类型</span><br><span class="line">//S2 L S3 L 红色</span><br><span class="line">//S2 L S3 H 蓝色</span><br><span class="line">//S2 H S3 L 无</span><br><span class="line">//S2 H S3 H 绿色</span><br><span class="line">void TSC_FilterColor(int Level01, int Level02)</span><br><span class="line">&#123;</span><br><span class="line">  if (Level01 != 0)</span><br><span class="line">    Level01 = HIGH;</span><br><span class="line"></span><br><span class="line">  if (Level02 != 0)</span><br><span class="line">    Level02 = HIGH;</span><br><span class="line"></span><br><span class="line">  digitalWrite(S2, Level01);</span><br><span class="line">  digitalWrite(S3, Level02);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//频率加一</span><br><span class="line">void TSC_Count() &#123;</span><br><span class="line">  g_count ++ ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//读取频率</span><br><span class="line">int readFrequecy(int type)</span><br><span class="line">&#123;</span><br><span class="line">  switch (type)</span><br><span class="line">  &#123;</span><br><span class="line">    case 0:</span><br><span class="line">      Serial.print(&quot;-&gt;Frequency RED = &quot;);</span><br><span class="line">      g_count = 0;</span><br><span class="line">      TSC_FilterColor(LOW, LOW);//Filter without Red</span><br><span class="line">      delay(1000);</span><br><span class="line">      //保存起来</span><br><span class="line">      g_array[0] = g_count;</span><br><span class="line">      Serial.println(g_array[0]);</span><br><span class="line">      return g_array[0];</span><br><span class="line">    case 1:</span><br><span class="line">      Serial.print(&quot;-&gt;Frequency GREEN = &quot;);</span><br><span class="line">      g_count = 0;</span><br><span class="line">      TSC_FilterColor(HIGH, HIGH);//Filter without Green</span><br><span class="line">      delay(1000);</span><br><span class="line">      //保存起来</span><br><span class="line">      g_array[1] = g_count;</span><br><span class="line">      Serial.println(g_array[1]);</span><br><span class="line">      return g_array[1];</span><br><span class="line">    case 2:</span><br><span class="line">      Serial.print(&quot;-&gt;Frequency BLUE = &quot;);</span><br><span class="line">      g_count = 0;</span><br><span class="line">      TSC_FilterColor(LOW, HIGH);</span><br><span class="line">      delay(1000);</span><br><span class="line">      //保存起来</span><br><span class="line">      g_array[2] = g_count;</span><br><span class="line">      Serial.println(g_array[2]);</span><br><span class="line">      return g_array[2];</span><br><span class="line">    default:</span><br><span class="line">      Serial.println(&quot;----- No Filter -----&quot;);</span><br><span class="line">      g_count = 0;</span><br><span class="line">      TSC_FilterColor(HIGH, LOW);             //Clear(no filter)</span><br><span class="line">      return 0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//读取红绿蓝三个频率</span><br><span class="line">void readAllFrequecy() &#123;</span><br><span class="line">  readFrequecy(0);</span><br><span class="line">  readFrequecy(1);</span><br><span class="line">  readFrequecy(2);</span><br><span class="line">  readFrequecy(3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//改变比例</span><br><span class="line">void changScaling(int type) &#123;</span><br><span class="line">  if (type == 1) &#123;</span><br><span class="line">    Serial.println(&quot;Change Scaling 20%&quot;);</span><br><span class="line">    //设置为20%</span><br><span class="line">    digitalWrite(S0, HIGH);</span><br><span class="line">    digitalWrite(S1, LOW);</span><br><span class="line">  &#125; else if (type == 2 ) &#123;</span><br><span class="line">    Serial.println(&quot;Change Scaling 100%&quot;);</span><br><span class="line">    //设置为100</span><br><span class="line">    digitalWrite(S0, HIGH);</span><br><span class="line">    digitalWrite(S1, HIGH);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    Serial.println(&quot;Change Scaling 2%&quot;);</span><br><span class="line">    //设置为2%</span><br><span class="line">    digitalWrite(S0, LOW);</span><br><span class="line">    digitalWrite(S1, HIGH);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//白平衡校验</span><br><span class="line">void whiteBlance() &#123;</span><br><span class="line">  readAllFrequecy();</span><br><span class="line"></span><br><span class="line">  g_SF[0] = 255.0 / g_array[0];    //R Scale factor</span><br><span class="line">  g_SF[1] = 255.0 / g_array[1] ;   //G Scale factor</span><br><span class="line">  g_SF[2] = 255.0 / g_array[2] ;   //B Scale factor</span><br><span class="line"></span><br><span class="line">  Serial.print(&quot;RED Scale factor :&quot;);</span><br><span class="line">  Serial.println(g_SF[0]);</span><br><span class="line">  Serial.print(&quot;GREEN Scale factor :&quot;);</span><br><span class="line">  Serial.println(g_SF[1]);</span><br><span class="line">  Serial.print(&quot;BLUE Scale factor :&quot;);</span><br><span class="line">  Serial.println(g_SF[2]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//读取颜色</span><br><span class="line">void readColor() &#123;</span><br><span class="line">  readAllFrequecy();</span><br><span class="line">  Serial.print(&quot;the color : &quot;);</span><br><span class="line">  for (int i = 0; i &lt; 3; i++) &#123;</span><br><span class="line">    int v = int(g_array[i] * g_SF[i]);</span><br><span class="line">    Serial.print(v &gt; 255 ? 255 : v);</span><br><span class="line">    if (i &lt; 2)</span><br><span class="line">      Serial.print(&quot; , &quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  Serial.println(&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">   获取红色</span><br><span class="line">*/</span><br><span class="line">void getRed() &#123;</span><br><span class="line">  int v = readFrequecy(0);</span><br><span class="line">  readFrequecy(3);</span><br><span class="line">  int red = int(v * g_SF[0]);</span><br><span class="line">  Serial.print(&quot;the color : &quot;);</span><br><span class="line">  Serial.print(red &gt; 255 ? 255 : red);</span><br><span class="line">  Serial.println(&quot; , 0 , 0&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">   获取绿色</span><br><span class="line">*/</span><br><span class="line">void getGreen() &#123;</span><br><span class="line">  int v = readFrequecy(1);</span><br><span class="line">  readFrequecy(3);</span><br><span class="line">  int green = int(v * g_SF[1]);</span><br><span class="line">  Serial.print(&quot;the color : 0 , &quot;);</span><br><span class="line">  Serial.print(green &gt; 255 ? 255 : green);</span><br><span class="line">  Serial.println(&quot; , 0&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">   获取蓝色</span><br><span class="line">*/</span><br><span class="line">void getBlue() &#123;</span><br><span class="line">  int v = readFrequecy(2);</span><br><span class="line">  readFrequecy(3);</span><br><span class="line">  int blue = int(v * g_SF[2]);</span><br><span class="line">  Serial.print(&quot;the color : 0 , 0 , &quot;);</span><br><span class="line">  Serial.print(blue &gt; 255 ? 255 : blue);</span><br><span class="line">  Serial.println(&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void( *resetFunc) (void) = 0;</span><br><span class="line"></span><br><span class="line">void setup()</span><br><span class="line">&#123;</span><br><span class="line">  TSC_Init();</span><br><span class="line">  Serial.begin(9600);</span><br><span class="line"></span><br><span class="line">  attachInterrupt(0, TSC_Count, RISING);</span><br><span class="line"></span><br><span class="line">  for (int i = 0; i &lt; 3; i++) &#123;</span><br><span class="line">    g_SF[i] = 1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop()</span><br><span class="line">&#123;</span><br><span class="line">  //通过串口控制</span><br><span class="line">  while (Serial.available() &gt; 0) &#123;</span><br><span class="line">    int v = Serial.parseInt();</span><br><span class="line">    Serial.read();</span><br><span class="line">    Serial.print(&quot;read value = &quot;);</span><br><span class="line">    Serial.println(v);</span><br><span class="line"></span><br><span class="line">    //根据读到的值进行操作</span><br><span class="line">    switch (v)  &#123;</span><br><span class="line">      case 0:</span><br><span class="line">        //进行白平衡</span><br><span class="line">        whiteBlance();</span><br><span class="line">        break;</span><br><span class="line">      case 1:</span><br><span class="line">        //读取颜色</span><br><span class="line">        readColor();</span><br><span class="line">        break;</span><br><span class="line">      case 2:</span><br><span class="line">        //只取红色</span><br><span class="line">        getRed();</span><br><span class="line">        break;</span><br><span class="line">      case 3:</span><br><span class="line">        //只取绿色</span><br><span class="line">        getGreen();</span><br><span class="line">        break;</span><br><span class="line">      case 4:</span><br><span class="line">        //只取蓝色</span><br><span class="line">        getBlue();</span><br><span class="line">        break;</span><br><span class="line">      case 11://关灯</span><br><span class="line">        Serial.println(&quot;led low&quot;);</span><br><span class="line">        digitalWrite(led, LOW);</span><br><span class="line">        break;</span><br><span class="line">      case 12: //开灯</span><br><span class="line">        Serial.println(&quot;led high&quot;);</span><br><span class="line">        digitalWrite(led, HIGH);</span><br><span class="line">        break;</span><br><span class="line">      case 30:// 2% 的比例</span><br><span class="line">        changScaling(0);</span><br><span class="line">        break;</span><br><span class="line">      case 31: // 20% 的比例</span><br><span class="line">        changScaling(1);</span><br><span class="line">        break;</span><br><span class="line">      case 32: // 100% 的比例</span><br><span class="line">        changScaling(2);</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        Serial.println(&quot;unknown command&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/16/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">王某某</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">150k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9:07</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  





</body>
</html>
